<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Byeong-Hak Choe">

<title>B.H. CHOE - Fall 2022 DANL 200 Final Exam 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">B.H. CHOE</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./cv.html">
 <span class="menu-text">about</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-danl200-lec" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">danl200-lec</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-danl200-lec">    
        <li>
    <a class="dropdown-item" href="./DANL200_Lec25_20230509.html">
 <span class="dropdown-text">lecture 25 - linear regression with interaction terms</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec24_20230504.html">
 <span class="dropdown-text">lecture 24 - linear regression with interaction terms</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec23_20230502.html">
 <span class="dropdown-text">lecture 23 - linear regression with log transformation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec22_20230427.html">
 <span class="dropdown-text">lecture 22 - linear regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec21_20230425.html">
 <span class="dropdown-text">lecture 21 - linear regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec20_20230420.html">
 <span class="dropdown-text">lecture 20 - linear regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec19_20230418.html">
 <span class="dropdown-text">lecture 19 - strings, dates and times, linear regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec18_20230413.html">
 <span class="dropdown-text">lecture 18 - factor, strings, dates and times</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec17_20230411.html">
 <span class="dropdown-text">lecture 17 - tidy data, joins</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec16_20230406.html">
 <span class="dropdown-text">lecture 16 - tidy data - pivot, separate, unite</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec15_20230323.html">
 <span class="dropdown-text">lecture 15 - log transformation, summarize, group operation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec14_20230321.html">
 <span class="dropdown-text">lecture 14 - summarize, group operation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec13_20230309.html">
 <span class="dropdown-text">lecture 13 - select, mutate</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec12_20230307.html">
 <span class="dropdown-text">lecture 12 - filter, arrange, select</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec11_20230302.html">
 <span class="dropdown-text">lecture 11 - visualization, filter</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec10_20230223.html">
 <span class="dropdown-text">lecture 10 - visualization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec09_20230221.html">
 <span class="dropdown-text">lecture 09 - ggplot, visualization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec08_20230216.html">
 <span class="dropdown-text">lecture 08 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec07_20230214.html">
 <span class="dropdown-text">lecture 07 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec06_20230209.html">
 <span class="dropdown-text">lecture 06 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec05_20230207.html">
 <span class="dropdown-text">lecture 05 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec04_20230202.html">
 <span class="dropdown-text">lecture 04 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec03_20230131.html">
 <span class="dropdown-text">lecture 03 - r basic, ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec02_20230126.html">
 <span class="dropdown-text">lecture 02 - r basic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_Lec01_20230124.html">
 <span class="dropdown-text">lecture 01 - syllabus</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-danl200-lab" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">danl200-lab</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-danl200-lab">    
        <li>
    <a class="dropdown-item" href="./DANL200_final_1a_fall_2022.html">
 <span class="dropdown-text">final-exam-1-fall-2022-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_final_2a_fall_2022.html">
 <span class="dropdown-text">final-exam-2-fall-2022-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_final_3a_fall_2022.html">
 <span class="dropdown-text">final-exam-3-fall-2022-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_hw4a.html">
 <span class="dropdown-text">hw4-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_hw3a.html">
 <span class="dropdown-text">hw3-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_lab5a.html">
 <span class="dropdown-text">lab5-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_lab4a.html">
 <span class="dropdown-text">lab4-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_lab3a.html">
 <span class="dropdown-text">lab3-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_midterm-spring-2023-a.html">
 <span class="dropdown-text">midterm-spring-2023-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_midterm-fall-2022-a.html">
 <span class="dropdown-text">midterm-fall-2022-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_midterm-spring-2022-a.html">
 <span class="dropdown-text">midterm-spring-2022-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_lab2a.html">
 <span class="dropdown-text">lab2-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_hw2a.html">
 <span class="dropdown-text">hw2-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_lab1a.html">
 <span class="dropdown-text">lab1-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL200_hw1a.html">
 <span class="dropdown-text">hw1-a</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-danl210-lec" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">danl210-lec</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-danl210-lec">    
        <li>
    <a class="dropdown-item" href="./DANL210_Lec25_20230509.html">
 <span class="dropdown-text">lecture 25 - unofficial api</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec24_20230504.html">
 <span class="dropdown-text">lecture 24 - api</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec23_20230502.html">
 <span class="dropdown-text">lecture 23 - web scrapping</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec22_20230427.html">
 <span class="dropdown-text">lecture 22 - web scrapping</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec21_20230425.html">
 <span class="dropdown-text">lecture 21 - web scrapping</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec20_20230420.html">
 <span class="dropdown-text">lecture 20 - web scrapping</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec19_20230418.html">
 <span class="dropdown-text">lecture 19 - web scrapping</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec18_20230413.html">
 <span class="dropdown-text">lecture 18 - missing data, dates and times</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec17_20230411.html">
 <span class="dropdown-text">lecture 17 - data concatenation, merges, missing data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec16_20230406.html">
 <span class="dropdown-text">lecture 16 - data types, data concatenation, merges</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec15_20230323.html">
 <span class="dropdown-text">lecture 15 - tidy, data types</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec14_20230321.html">
 <span class="dropdown-text">lecture 14 - agg, transform, filter, tidy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec13_20230309.html">
 <span class="dropdown-text">lecture 13 - agg, transform, filter</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec12_20230307.html">
 <span class="dropdown-text">lecture 12 - seaborn, agg</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec11_20230302.html">
 <span class="dropdown-text">lecture 11 - seaborn</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec10_20230223.html">
 <span class="dropdown-text">lecture 10 - eda</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec09_20230221.html">
 <span class="dropdown-text">lecture 09 - apply</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec08_20230216.html">
 <span class="dropdown-text">lecture 08 - query, drop, sort, rank, assign, lambda</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec07_20230214.html">
 <span class="dropdown-text">lecture 07 - drop, sort, rank, assign, lambda</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec06_20230209.html">
 <span class="dropdown-text">lecture 06 - pandas boolean subsetting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec05_20230207.html">
 <span class="dropdown-text">lecture 05 - pandas loc iloc</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec04_20230202.html">
 <span class="dropdown-text">lecture 04 - python basic, pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec03_20230131.html">
 <span class="dropdown-text">lecture 03 - python basic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec02_20230126.html">
 <span class="dropdown-text">lecture 02 - python basic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_Lec01_20230124.html">
 <span class="dropdown-text">lecture 01 - syllabus</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-danl210-lab" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">danl210-lab</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-danl210-lab">    
        <li>
    <a class="dropdown-item" href="./DANL210_hw5q.html">
 <span class="dropdown-text">hw5-q - Automation - World Bank Climate Change Knowledge</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_hw4a.html">
 <span class="dropdown-text">hw4-a - Web-scrapping - Books</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_hw3a.html">
 <span class="dropdown-text">hw3-a - Web-scrapping - IMDB</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_lab8a.html">
 <span class="dropdown-text">lab8-a - Web-scrapping 3 - Quotes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_lab7a.html">
 <span class="dropdown-text">lab7-a - Web-scrapping 2 - EIA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_lab6a.html">
 <span class="dropdown-text">lab6-a - Web-scrapping 1 - HTML Table</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_lab5a.html">
 <span class="dropdown-text">lab5-a - datetime</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_lab4a.html">
 <span class="dropdown-text">lab4-a - concat, merge</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_midterm-spring-2023-a.html">
 <span class="dropdown-text">midterm-spring-2023-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_lab3a.html">
 <span class="dropdown-text">lab3-a - melt, pivot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_hw2a.html">
 <span class="dropdown-text">hw2-a - pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_lab2a.html">
 <span class="dropdown-text">lab2-a - pandas, seaborn</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_lab1a.html">
 <span class="dropdown-text">lab1-a - pandas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL210_hw1a.html">
 <span class="dropdown-text">hw1-a - pandas</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-danl310-lec" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">danl310-lec</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-danl310-lec">    
        <li>
    <a class="dropdown-item" href="./DANL310_Lec24_20230504.html">
 <span class="dropdown-text">lecture 24 - quarto</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec23_20230502.html">
 <span class="dropdown-text">lecture 23 - data viz</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_shiny_workshop.pdf">
 <span class="dropdown-text">lecture 22 - shiny apps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_shiny_workshop.pdf">
 <span class="dropdown-text">lecture 21 - shiny apps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_shiny_workshop.pdf">
 <span class="dropdown-text">lecture 20 - shiny apps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec19_20230418.html">
 <span class="dropdown-text">lecture 19 - tables</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec18_20230413.html">
 <span class="dropdown-text">lecture 18 - animation ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec17_20230411.html">
 <span class="dropdown-text">lecture 17 - interactive ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec15_20230323.html">
 <span class="dropdown-text">lecture 15 - maps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec14_20230321.html">
 <span class="dropdown-text">lecture 14 - maps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec13_20230309.html">
 <span class="dropdown-text">lecture 13 - color, theme</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec12_20230307.html">
 <span class="dropdown-text">lecture 12 - work with model</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec11_20230302.html">
 <span class="dropdown-text">lecture 11 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec10_20230223.html">
 <span class="dropdown-text">lecture 10 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec09_20230221.html">
 <span class="dropdown-text">lecture 09 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec08_20230216.html">
 <span class="dropdown-text">lecture 08 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec07_20230214.html">
 <span class="dropdown-text">lecture 07 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec06_20230209.html">
 <span class="dropdown-text">lecture 06 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec05_20230207.html">
 <span class="dropdown-text">lecture 05 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec04_20230202.html">
 <span class="dropdown-text">lecture 04 - ggplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec03_20230131.html">
 <span class="dropdown-text">lecture 03 - rmarkdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec02_20230126.html">
 <span class="dropdown-text">lecture 02 - github website, rmarkdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_Lec01_20230124.html">
 <span class="dropdown-text">lecture 01 - syllabus</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-danl310-lab" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">danl310-lab</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-danl310-lab">    
        <li>
    <a class="dropdown-item" href="./DANL310_lab4q.html">
 <span class="dropdown-text">lab4-q</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./shiny-04.html">
 <span class="dropdown-text">shiny-04: interactive storm map</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./shiny-03.html">
 <span class="dropdown-text">shiny-03: storms filtered</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./shiny-02.html">
 <span class="dropdown-text">shiny-02: storms by year</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./shiny-01.html">
 <span class="dropdown-text">shiny-01: old faithful</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./git-large-file-push.html">
 <span class="dropdown-text">Large-File-Push to GitHub Repo</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_midterm-spring-2023-a.html">
 <span class="dropdown-text">midterm-spring-2023-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_midterm-spring-2023-q.html">
 <span class="dropdown-text">midterm-spring-2023-q</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_lab3a.html">
 <span class="dropdown-text">lab3-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_lab3q.html">
 <span class="dropdown-text">lab3-q</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_lab2a.html">
 <span class="dropdown-text">lab2-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_lab2q.html">
 <span class="dropdown-text">lab2-q</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_lab1a.html">
 <span class="dropdown-text">lab1-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_lab1q.html">
 <span class="dropdown-text">lab1-q</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_hw2a.html">
 <span class="dropdown-text">hw2-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_hw2q.html">
 <span class="dropdown-text">hw2-q</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_hw1a.html">
 <span class="dropdown-text">hw1-a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./DANL310_hw1q.html">
 <span class="dropdown-text">hw1-q</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-ml-lab" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">ml-lab</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-ml-lab">    
        <li>
    <a class="dropdown-item" href="./mba-ch1-lm.html">
 <span class="dropdown-text">linear regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mba-ch1-logit.html">
 <span class="dropdown-text">logistic regression (classification)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mba-ch3-regularization.html">
 <span class="dropdown-text">regularization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mba-ch3-model-selection.html">
 <span class="dropdown-text">model selection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mba-ch7-tree-based-methods.html">
 <span class="dropdown-text">tree-based methods</span></a>
  </li>  
        <li class="dropdown-header">clustering</li>
        <li class="dropdown-header">principal component analysis</li>
    </ul>
  </li>
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-r-packages" id="toc-load-r-packages" class="nav-link active" data-scroll-target="#load-r-packages">Load R packages</a></li>
  <li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1">Question 1</a>
  <ul class="collapse">
  <li><a href="#variable-description" id="toc-variable-description" class="nav-link" data-scroll-target="#variable-description">Variable description</a></li>
  <li><a href="#q1a." id="toc-q1a." class="nav-link" data-scroll-target="#q1a.">Q1a.</a></li>
  <li><a href="#q1b." id="toc-q1b." class="nav-link" data-scroll-target="#q1b.">Q1b.</a></li>
  <li><a href="#q1c." id="toc-q1c." class="nav-link" data-scroll-target="#q1c.">Q1c.</a></li>
  <li><a href="#q1d." id="toc-q1d." class="nav-link" data-scroll-target="#q1d.">Q1d.</a></li>
  <li><a href="#q1e." id="toc-q1e." class="nav-link" data-scroll-target="#q1e.">Q1e.</a></li>
  <li><a href="#q1f." id="toc-q1f." class="nav-link" data-scroll-target="#q1f.">Q1f.</a></li>
  <li><a href="#q1g." id="toc-q1g." class="nav-link" data-scroll-target="#q1g.">Q1g.</a></li>
  </ul></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a>
  <ul class="collapse">
  <li><a href="#variable-description-1" id="toc-variable-description-1" class="nav-link" data-scroll-target="#variable-description-1">Variable description</a></li>
  <li><a href="#q2a." id="toc-q2a." class="nav-link" data-scroll-target="#q2a.">Q2a.</a></li>
  <li><a href="#q2b." id="toc-q2b." class="nav-link" data-scroll-target="#q2b.">Q2b.</a></li>
  <li><a href="#q2c." id="toc-q2c." class="nav-link" data-scroll-target="#q2c.">Q2c.</a></li>
  <li><a href="#q2d." id="toc-q2d." class="nav-link" data-scroll-target="#q2d.">Q2d.</a></li>
  <li><a href="#q2e." id="toc-q2e." class="nav-link" data-scroll-target="#q2e.">Q2e.</a></li>
  <li><a href="#q2f." id="toc-q2f." class="nav-link" data-scroll-target="#q2f.">Q2f.</a></li>
  <li><a href="#q2g." id="toc-q2g." class="nav-link" data-scroll-target="#q2g.">Q2g.</a></li>
  <li><a href="#q2h." id="toc-q2h." class="nav-link" data-scroll-target="#q2h.">Q2h.</a></li>
  <li><a href="#q2i." id="toc-q2i." class="nav-link" data-scroll-target="#q2i.">Q2i.</a></li>
  </ul></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a>
  <ul class="collapse">
  <li><a href="#variable-description-2" id="toc-variable-description-2" class="nav-link" data-scroll-target="#variable-description-2">Variable description</a></li>
  <li><a href="#q3a." id="toc-q3a." class="nav-link" data-scroll-target="#q3a.">Q3a.</a></li>
  <li><a href="#q3b." id="toc-q3b." class="nav-link" data-scroll-target="#q3b.">Q3b.</a></li>
  <li><a href="#q3c." id="toc-q3c." class="nav-link" data-scroll-target="#q3c.">Q3c.</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Fall 2022 DANL 200 Final Exam 2</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Byeong-Hak Choe </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="load-r-packages" class="level1">
<h1>Load R packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-1" class="level1">
<h1>Question 1</h1>
<p>The following is the data.frame for Question 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>NFL2022_stuffs <span class="ot">&lt;-</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"https://bcdanl.github.io/data/NFL2022_stuffs.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p><code>NFL2022_stuffs</code> is the data.frame that contains information about NFL games in year 2022, in which the unit of observation is a single play for each drive in a NFL game.</p></li>
<li><p>cf) A drive in American football is a word used to describe what a team’s offense does with the football while it is in their possession and the series of plays that follow their gaining possession of the ball.</p></li>
</ul>
<section id="variable-description" class="level2">
<h2 class="anchored" data-anchor-id="variable-description">Variable description</h2>
<ul>
<li><code>play_id</code>: Numeric play identifier that when used with <code>game_id</code> and <code>drive</code> provides the unique identifier for a single play</li>
<li><code>game_id</code>: Ten digit identifier for NFL game.</li>
<li><code>drive</code>: Numeric drive number in the game.</li>
<li><code>week</code>: Season week.</li>
<li><code>posteam</code>: String abbreviation for the team with possession.</li>
<li><code>qtr</code>: Quarter of the game (5 is overtime).</li>
<li><code>half_seconds_remaining</code>: Numeric seconds remaining in the half.</li>
<li><code>down</code>: The down for the given play.
<ul>
<li>Basically you get four attempts (a.k.a. downs) to move the ball 10 yards (by either running with it or passing it).</li>
<li>If you make 10 yards then you get another set of four downs.</li>
</ul></li>
<li><code>pass</code>: Binary indicator if the play was a pass play.</li>
<li><code>wp</code>: Estimated winning probability for the <code>posteam</code> given the current situation at the start of the given play.</li>
</ul>
<p><br></p>
</section>
<section id="q1a." class="level2">
<h2 class="anchored" data-anchor-id="q1a.">Q1a.</h2>
<p>In data.frame, <code>NFL2022_stuffs</code>, remove observations for which values of <code>posteam</code> is missing.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>q1a <span class="ot">&lt;-</span> NFL2022_stuffs <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(posteam))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="q1b." class="level2">
<h2 class="anchored" data-anchor-id="q1b.">Q1b.</h2>
<ul>
<li>Summarize the mean value of <code>pass</code> for each <code>posteam</code> when all the following conditions hold:
<ul>
<li><ol type="1">
<li><code>wp</code> is greater than 20% and less than 75%;</li>
</ol></li>
<li><ol start="2" type="1">
<li><code>down</code> is less than or equal to 2; and</li>
</ol></li>
<li><ol start="3" type="1">
<li><code>half_seconds_remaining</code> is greater than 120.</li>
</ol></li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>q1b <span class="ot">&lt;-</span> q1a <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wp <span class="sc">&gt;</span> .<span class="dv">20</span>, wp <span class="sc">&lt;</span> .<span class="dv">75</span>, down <span class="sc">&lt;=</span> <span class="dv">2</span>, qtr <span class="sc">&lt;=</span> <span class="dv">2</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         half_seconds_remaining <span class="sc">&gt;</span> <span class="dv">120</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(posteam) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_pass =</span> <span class="fu">mean</span>(pass), </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">plays =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(mean_pass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="q1c." class="level2">
<h2 class="anchored" data-anchor-id="q1c.">Q1c.</h2>
<ul>
<li><p>Provide both (1) a ggplot code with <code>geom_point()</code> using the resulting data.frame in Q1b and (2) a simple comments to describe the mean value of <code>pass</code> for each <code>posteam</code>.</p></li>
<li><p>In the ggplot, reorder the <code>posteam</code> categories based on the mean value of <code>pass</code> in ascending or in descending order.</p></li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> q1b,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>( <span class="at">x =</span> <span class="fu">reorder</span>(posteam,<span class="sc">-</span>mean_pass), </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> mean_pass)) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="DANL200_final_2a_fall_2022_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Comments are not provided here.</p>
<p><br></p>
</section>
<section id="q1d." class="level2">
<h2 class="anchored" data-anchor-id="q1d.">Q1d.</h2>
<ul>
<li><p>Download the CSV file, NFL2022_epa.csv.</p></li>
<li><p>Variable description for NFL2022_epa.csv</p>
<ul>
<li><code>play_id</code>: Numeric play identifier that when used with <code>game_id</code> and <code>drive</code> provides the unique identifier for a single play</li>
<li><code>game_id</code>: Ten digit identifier for NFL game.</li>
<li><code>drive</code>: Numeric drive number in the game.</li>
<li><code>posteam</code>: String abbreviation for the team with possession.</li>
<li><code>passer</code>: Name of the player who passed a ball to a receiver by initially taking a three-step drop, backpedaling into the pocket to make a pass. (Mostly, the quarterbacks)</li>
<li><code>receiver</code>: Name of the receiver.</li>
<li><code>epa</code>: Expected points added (EPA) by the posteam for the given play.</li>
</ul></li>
<li><p>Read the CSV file, <code>NFL2022_epa.csv</code>, as data.frame with the name, <code>NFL2022_epa</code>.</p></li>
<li><p>Then, create the data.frame, <code>NFL2022_stuffs_EPA</code>, that includes</p>
<ul>
<li><ol type="1">
<li>all the variables in the data.frame, <code>NFL2022_stuffs</code>, and</li>
</ol></li>
<li><ol start="2" type="1">
<li><code>passer</code>, <code>receiver</code>, and <code>epa</code> in the data.frame, <code>NFL2022_epa</code> by joining the two data.frames.</li>
</ol></li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>NFL2022_epa <span class="ot">&lt;-</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"/Users/byeong-hakchoe/Google Drive/suny-geneseo/teaching-materials/lecture-data/NFL2022_epa.csv"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>q1d <span class="ot">&lt;-</span> NFL2022_stuffs <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(NFL2022_epa) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(passer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="q1e." class="level2">
<h2 class="anchored" data-anchor-id="q1e.">Q1e.</h2>
<ul>
<li>Provide both (1) a single ggplot and (2) a simple comment to describe the NFL weekly trend of <code>week</code>ly mean value of <code>epa</code> for each of passers, (a) <code>passer == "J.Allen"</code> and (b) <code>passer == "P.Mahomes"</code>.</li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>q1e <span class="ot">&lt;-</span> q1d <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( <span class="fu">str_detect</span>(passer, <span class="st">"J.Allen"</span>) <span class="sc">|</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_detect</span>(passer, <span class="st">"P.Mahomes"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(week, passer) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_epa =</span> <span class="fu">mean</span>(epa, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( q1e, </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> mean_epa, <span class="at">color =</span> passer) ) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="DANL200_final_2a_fall_2022_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
</section>
<section id="q1f." class="level2">
<h2 class="anchored" data-anchor-id="q1f.">Q1f.</h2>
<ul>
<li>Calculate the difference between the mean value of <code>epa</code> for <code>passer == "J.Allen"</code> the mean value of <code>epa</code> for <code>passer == "P.Mahomes"</code> for each value of <code>week</code>.</li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>q1f <span class="ot">&lt;-</span> q1e <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> mean_epa,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> passer) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_epa =</span> J.Allen <span class="sc">-</span> P.Mahomes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="q1g." class="level2">
<h2 class="anchored" data-anchor-id="q1g.">Q1g.</h2>
<ul>
<li>Summarize the resulting data.frame in Q1d, with the following four variables:
<ul>
<li><code>posteam</code>: String abbreviation for the team with possession.</li>
<li><code>passer</code>: Name of the player who passed a ball to a receiver by initially taking a three-step drop, backpedaling into the pocket to make a pass. (Mostly, the quarterbacks)</li>
<li><code>mean_epa</code>: Mean value of epa in 2022 for each passer</li>
<li><code>n_pass</code>: Number of observations for each passer</li>
</ul></li>
<li>Then find the top 10 NFL passers in 2022 in terms of the mean value of <code>epa</code>, conditioning that <code>n_pass</code> must be greater than or equal to the third quartile level of <code>n_pass</code>.</li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>q1g <span class="ot">&lt;-</span> q1d <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(posteam, passer) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_epa =</span> <span class="fu">mean</span>(epa, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(q1g) <span class="co"># to see the third quartile</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">q1g</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">posteam</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">passer</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 15%">
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mean_epa</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">-6.89</td>
<td style="text-align: right;">-0.3</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">3.77</td>
<td style="text-align: left;">▁▁▁▇▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">n</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">167.48</td>
<td style="text-align: right;">204.66</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">58.00</td>
<td style="text-align: right;">355.00</td>
<td style="text-align: right;">636.00</td>
<td style="text-align: left;">▇▁▁▂▁</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>q1g <span class="ot">&lt;-</span> q1g <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">355</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>mean_epa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br><br></p>
</section>
</section>
<section id="question-2" class="level1">
<h1>Question 2</h1>
<ul>
<li><p>The following is the description for Question 2:</p></li>
<li><p>The income tax exemption scheme for pension savings is a system that reduces an income tax burden, so that individuals can build up more personal pensions to help them ensure their well-being in old age.</p></li>
<li><p>In particular, from 2005 to 2006, the tax authority expanded the limit amount of income tax exemption for pension savings from $2,000 to $3,000.</p></li>
<li><p>That is to say, pension savings were exempt from income tax up to $2,000 in 2005, and increased to $3,000 for the 2006 tax year.</p></li>
<li><p>The following data.frame comes from the Census and the tax authority, and covers households in years 2005-2006:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pension_tax <span class="ot">&lt;-</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"https://bcdanl.github.io/data/pension_tax_cleaned.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="variable-description-1" class="level2">
<h2 class="anchored" data-anchor-id="variable-description-1">Variable description</h2>
<ul>
<li><code>hh_id</code>: Household Identification (ID) number.</li>
<li><code>gender</code>: Gender (Female or Male).</li>
<li><code>schooling</code>: Level of educational attainment.</li>
<li><code>region</code>: City-level geographic region.</li>
<li><code>year</code>: Year (2005 or 2006).</li>
<li><code>pension_saving</code>: Amount of yearly pension saving (in $).</li>
<li><code>saving3000below</code>: TRUE if <code>pension_saving</code> in 2005 is less than $3,000; <code>FALSE</code> otherwise.</li>
<li><code>family_size</code>: Family size (non-negative integer values).</li>
<li><code>net_asset</code>: Net asset (in $1,000).</li>
<li><code>public_pension</code>: <code>TRUE</code> if the type of pension is public; <code>FALSE</code> otherwise.</li>
<li><code>home_owner</code>: <code>TRUE</code> if household owns a house; <code>FALSE</code> otherwise.</li>
<li><code>age</code>: Age of the household member who is a main income contributor.</li>
<li><code>age_sq</code>: Age squared.</li>
<li><code>hh_expenditure</code>: Household expenditure.</li>
<li><code>hh_income</code>: Household income.</li>
</ul>
<p><br></p>
</section>
<section id="q2a." class="level2">
<h2 class="anchored" data-anchor-id="q2a.">Q2a.</h2>
<p>Report (1) minimum, (2) median, (3) maximum, (4) mean, and (5) standard deviation of variable <code>pension_saving</code> for New York, NY.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pension_tax<span class="sc">$</span>region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Charlotte, NC       Chicago, IL      Columbus, OH        Denver, CO 
               23                26                22                 5 
      Houston, TX  Indianapolis, IN  Jacksonville, FL   Los Angeles, CA 
               31                20                14               103 
    Nashville, TN      New York, NY Oklahoma City, OK  Philadelphia, PA 
               16                98                 9                13 
      Phoenix, AZ       Seattle, WA    Washington, DC 
                6                15                22 </code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pension_tax <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"New York, NY"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">skim</span>(pension_saving)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">Piped data</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">98</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">pension_saving</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2402.55</td>
<td style="text-align: right;">1536.21</td>
<td style="text-align: right;">557.24</td>
<td style="text-align: right;">1370.19</td>
<td style="text-align: right;">2066.74</td>
<td style="text-align: right;">2786.19</td>
<td style="text-align: right;">6965.48</td>
<td style="text-align: left;">▇▆▂▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
</section>
<section id="q2b." class="level2">
<h2 class="anchored" data-anchor-id="q2b.">Q2b.</h2>
<p>Using the given data.frame, <code>pension_tax</code>, create the data.frame, <code>pension_tax</code>, for which - (1) <code>year</code> is a factor-type variable of <code>year</code> with a reference level, 2005. - (2) <code>schooling</code> is a factor-type variable of <code>schooling</code> with the following order of levels, defined in the <code>educ</code> vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>educ <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"Bachelor's Degree"</span>, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Elementary School"</span>, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Middle School"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"High School Diploma"</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Associate's Degree"</span>, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Master's Degree"</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Ph.D. Degree"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Answer</li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pension_tax <span class="ot">&lt;-</span> pension_tax <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">year =</span> <span class="fu">factor</span>(year, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2005</span>, <span class="dv">2006</span>) ),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">schooling =</span> <span class="fu">factor</span>(schooling, <span class="at">levels =</span> educ )</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># levels(pension_tax$year)</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># levels(pension_tax$schooling)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="q2c." class="level2">
<h2 class="anchored" data-anchor-id="q2c.">Q2c.</h2>
<p>Provide both (1) ggplot and (2) simple comments to describe the trend for the mean value of <code>log(pension_saving)</code> for each group of <code>saving3000below</code>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>q2c <span class="ot">&lt;-</span> pension_tax <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, saving3000below) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>( <span class="at">mean_log_pension_saving =</span> <span class="fu">mean</span>( <span class="fu">log</span>(pension_saving) ) )</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>q2c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Groups:   year [2]
  year  saving3000below mean_log_pension_saving
  &lt;fct&gt; &lt;lgl&gt;                             &lt;dbl&gt;
1 2005  FALSE                              8.48
2 2005  TRUE                               7.44
3 2006  FALSE                              8.29
4 2006  TRUE                               7.60</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> q2c,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> mean_log_pension_saving,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> saving3000below, <span class="at">color =</span> saving3000below) ) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">lty =</span> saving3000below)  ) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="DANL200_final_2a_fall_2022_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Comments are not provided here.</p>
<p><br></p>
</section>
<section id="q2d." class="level2">
<h2 class="anchored" data-anchor-id="q2d.">Q2d.</h2>
<p>Provide both (1) ggplot and (2) simple comments to describe the trend for the distribution of <code>log(pension_saving)</code> for each group of <code>saving3000below</code>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pension_tax,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year), <span class="at">y =</span> <span class="fu">log</span>(pension_saving))) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( <span class="fu">aes</span>(<span class="at">fill =</span> saving3000below ),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>) ) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>( <span class="fu">aes</span>( <span class="at">group =</span> saving3000below ),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">fun =</span> mean,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> q2c,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year), <span class="at">y =</span> mean_log_pension_saving,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> saving3000below, <span class="at">color =</span> saving3000below,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">lty =</span> saving3000below),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="DANL200_final_2a_fall_2022_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Comments are not provided here.</p>
<p><br></p>
</section>
<section id="q2e." class="level2">
<h2 class="anchored" data-anchor-id="q2e.">Q2e.</h2>
<ul>
<li><p>Remove the observations in the data.frame, pension_tax, if the number of observations for each <code>hh_id</code> is 1.</p></li>
<li><p>Then, randomly split the data.frame, pension_tax, into training and testing data.frames.</p></li>
<li><p>Approximately 75% of observations in the data.frame, pension_tax, must go to the training data.frame.</p></li>
<li><p>The rest observations in the the data.frame, pension_tax, must go to the testing data.frame.</p></li>
<li><p>Additionally, in both training and testing data.frames,</p>
<ul>
<li><ol type="1">
<li>the number of observations for each <code>hh_id</code> must be 2.</li>
</ol></li>
<li><ol start="2" type="1">
<li>the fraction of observations with <code>saving3000below</code> == TRUE must be approximately 75%.</li>
</ol></li>
<li><ol start="3" type="1">
<li>the fraction of observations with <code>saving3000below</code> == FALSE must be approximately 25%.</li>
</ol></li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>q1c <span class="ot">&lt;-</span> pension_tax <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hh_id) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="fu">n</span>() ) <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( n <span class="sc">==</span> <span class="dv">2</span> )</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>q1c_T <span class="ot">&lt;-</span> q1c <span class="sc">%&gt;%</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( saving3000below <span class="sc">==</span> T )<span class="sc">%&gt;%</span>  <span class="co"># 214</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hh_id) <span class="sc">%&gt;%</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="fu">n</span>() ) <span class="sc">%&gt;%</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( n <span class="sc">==</span> <span class="dv">2</span> ) <span class="sc">%&gt;%</span>  <span class="co"># 214</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>q1c_F <span class="ot">&lt;-</span> q1c <span class="sc">%&gt;%</span> </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( saving3000below <span class="sc">==</span> F )<span class="sc">%&gt;%</span> <span class="co"># 82</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hh_id) <span class="sc">%&gt;%</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="fu">n</span>() ) <span class="sc">%&gt;%</span> </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( n <span class="sc">==</span> <span class="dv">2</span> ) <span class="sc">%&gt;%</span>  <span class="co"># 82</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>q1c_T_05 <span class="ot">&lt;-</span> q1c_T <span class="sc">%&gt;%</span> </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( year <span class="sc">==</span> <span class="dv">2005</span> )</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>q1c_T_06 <span class="ot">&lt;-</span> q1c_T <span class="sc">%&gt;%</span> </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( year <span class="sc">==</span> <span class="dv">2006</span> )</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>q1c_F_05 <span class="ot">&lt;-</span> q1c_F <span class="sc">%&gt;%</span> </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( year <span class="sc">==</span> <span class="dv">2005</span> )</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>q1c_F_06 <span class="ot">&lt;-</span> q1c_F <span class="sc">%&gt;%</span> </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( year <span class="sc">==</span> <span class="dv">2006</span> )</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>gp_T <span class="ot">&lt;-</span> <span class="fu">runif</span>( <span class="fu">nrow</span>(q1c_T_05)) </span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>gp_F <span class="ot">&lt;-</span> <span class="fu">runif</span>( <span class="fu">nrow</span>(q1c_F_05) )</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>q1c_T_05_train <span class="ot">&lt;-</span> q1c_T_05 <span class="sc">%&gt;%</span> </span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_T <span class="sc">&gt;</span> .<span class="dv">25</span>)</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>q1c_T_06_train <span class="ot">&lt;-</span> q1c_T_06 <span class="sc">%&gt;%</span> </span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_T <span class="sc">&gt;</span> .<span class="dv">25</span>)</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>q1c_F_05_train <span class="ot">&lt;-</span> q1c_F_05 <span class="sc">%&gt;%</span> </span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_F <span class="sc">&gt;</span> .<span class="dv">25</span>)</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>q1c_F_06_train <span class="ot">&lt;-</span> q1c_F_06 <span class="sc">%&gt;%</span> </span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_F <span class="sc">&gt;</span> .<span class="dv">25</span>)</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>q1c_T_05_test <span class="ot">&lt;-</span> q1c_T_05 <span class="sc">%&gt;%</span> </span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_T <span class="sc">&lt;=</span> .<span class="dv">25</span>)</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>q1c_T_06_test <span class="ot">&lt;-</span> q1c_T_06 <span class="sc">%&gt;%</span> </span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_T <span class="sc">&lt;=</span> .<span class="dv">25</span>)</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>q1c_F_05_test <span class="ot">&lt;-</span> q1c_F_05 <span class="sc">%&gt;%</span> </span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_F <span class="sc">&lt;=</span> .<span class="dv">25</span>)</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>q1c_F_06_test <span class="ot">&lt;-</span> q1c_F_06 <span class="sc">%&gt;%</span> </span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_F <span class="sc">&lt;=</span> .<span class="dv">25</span>)</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>dtrain <span class="ot">&lt;-</span> <span class="fu">rbind</span>(q1c_T_05_train, q1c_T_06_train,</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>                q1c_F_05_train, q1c_F_06_train) <span class="sc">%&gt;%</span> </span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(hh_id, year)</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>dtest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(q1c_T_05_test, q1c_T_06_test,</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>               q1c_F_05_test, q1c_F_06_test) <span class="sc">%&gt;%</span> </span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(hh_id, year)</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>( dtrain <span class="sc">%&gt;%</span> <span class="fu">count</span>(hh_id) <span class="sc">%&gt;%</span> <span class="fu">select</span>(n) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">dtrain %&gt;% count(hh_id) %…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">109</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">▁▁▇▁▁</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>( dtest <span class="sc">%&gt;%</span> <span class="fu">count</span>(hh_id) <span class="sc">%&gt;%</span> <span class="fu">select</span>(n) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">dtest %&gt;% count(hh_id) %&gt;…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">▁▁▇▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
</section>
<section id="q2f." class="level2">
<h2 class="anchored" data-anchor-id="q2f.">Q2f.</h2>
<p>Consider the following formula for linear regression:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="fu">log</span>(pension_saving) <span class="sc">~</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  saving3000below <span class="sc">*</span> year <span class="sc">+</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(hh_income) <span class="sc">+</span> <span class="fu">log</span>(hh_expenditure) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  family_size <span class="sc">+</span> net_asset <span class="sc">+</span> schooling <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  gender <span class="sc">+</span> age <span class="sc">+</span> age_sq <span class="sc">+</span> public_pension</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Train the linear regression model with the above formula.</p></li>
<li><p>If you could not properly split the data.frame into the training and testing data.frames in Q2e, use the data.frame, <code>pension_tax</code>, as the training data.frame.</p></li>
<li><p>Report the summary of the linear regression result.</p></li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dtrain <span class="ot">&lt;-</span> dtrain <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">net_asset =</span> net_asset <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>( formula, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> dtrain )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(model, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>

<table style="text-align:center">
<tbody><tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
log(pension_saving)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
saving3000below
</td>
<td>
-0.839<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.106)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
year2006
</td>
<td>
-0.377<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.152)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
log(hh_income)
</td>
<td>
0.210<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.121)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
log(hh_expenditure)
</td>
<td>
0.222
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.139)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
family_size
</td>
<td>
-0.052
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.046)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
net_asset
</td>
<td>
0.0004<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.0002)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
schoolingMiddle School
</td>
<td>
0.155
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.373)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
schoolingHigh School Diploma
</td>
<td>
0.231<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.085)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
schoolingAssociate’s Degree
</td>
<td>
0.038
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.101)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
schoolingMaster’s Degree
</td>
<td>
0.363<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.106)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
schoolingPh.D. Degree
</td>
<td>
0.047
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.211)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
genderMale
</td>
<td>
0.793<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.187)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
age
</td>
<td>
-0.026
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.047)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
age_sq
</td>
<td>
0.0002
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.001)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
public_pension
</td>
<td>
-0.072
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.121)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
saving3000belowTRUE:year2006
</td>
<td>
0.441<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.141)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
4.780<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1.314)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
218
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.475
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.433
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.461 (df = 201)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
11.367<sup>***</sup> (df = 16; 201)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup><em>p&lt;0.1; <sup><strong></strong></sup><strong>p&lt;0.05; <sup></sup></strong></em>p&lt;0.01
</td>
</tr>

</tbody></table>
<p><br></p>
</section>
<section id="q2g." class="level2">
<h2 class="anchored" data-anchor-id="q2g.">Q2g.</h2>
<ul>
<li><p>Visualize the confidence intervals of all the beta estimates except for the variables <code>(Intercept)</code> and <code>saving3000below</code>.</p></li>
<li><p>What does it mean that a confidence interval of a beta estimate contains a zero level of its beta estimate?</p></li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>sum_model <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>, term <span class="sc">!=</span> <span class="st">"saving3000belowTRUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">star =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;=</span> .<span class="dv">1</span>, T, F)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(star, <span class="fu">everything</span>())</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sum_model) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>( <span class="fu">aes</span>(<span class="at">x =</span> term, </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> estimate,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ymin =</span> estimate <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>std.error,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ymax =</span> estimate <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>std.error ) ) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="DANL200_final_2a_fall_2022_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>If <code>estimate == 0</code> belongs to a confidence interval of the beta estimate, the beta estimate may not be statistically different from zero, and there is insufficient evidence to conclude that there is a non-zero relationship between the explanatory variable and the outcome variable.</li>
</ul>
<p><br></p>
</section>
<section id="q2h." class="level2">
<h2 class="anchored" data-anchor-id="q2h.">Q2h.</h2>
<p>Interpret the estimated beta coefficients for the following variables—</p>
<ul>
<li><ol type="1">
<li><code>genderMale</code></li>
</ol></li>
<li><ol start="2" type="1">
<li><code>log(hh_income)</code></li>
</ol></li>
<li><ol start="3" type="1">
<li><code>schoolingHigh School Diploma</code></li>
</ol></li>
<li><ol start="4" type="1">
<li><code>net_asset</code></li>
</ol></li>
</ul>
<p>—from the model with <code>formula</code> in Q2f.</p>
<ul>
<li>Interpretation is not provided here.</li>
</ul>
<p><br></p>
</section>
<section id="q2i." class="level2">
<h2 class="anchored" data-anchor-id="q2i.">Q2i.</h2>
<p>Provide (1) the interpretation of the beta estimate corresponding to the following question— - How did the tax exemption of household income affect the <code>pension_saving</code>? —and (2) any intuitive explanations on it.</p>
<ul>
<li>Answer
<ul>
<li>Workers who had less than $3,000 in pension savings in 2005 had an incentive to further increase their pension savings in 2006, as the upper limit of income tax deduction increases.</li>
<li>On the other hand, workers who had more than $3,000 in pension savings in 2005 were hardly affected by the change in the upper limit.</li>
</ul></li>
</ul>
<p><br><br></p>
</section>
</section>
<section id="question-3" class="level1">
<h1>Question 3</h1>
<p>The following is the data.frame for Question 3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>NYComplaints <span class="ot">&lt;-</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"https://bcdanl.github.io/data/NYComplaints.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The data.frame, NYComplaints, contains information about complaints from New York City.</li>
</ul>
<section id="variable-description-2" class="level2">
<h2 class="anchored" data-anchor-id="variable-description-2">Variable description</h2>
<ul>
<li><code>unique_key</code>: Complaint identifier.</li>
<li><code>year_open</code>, <code>month_open</code>, <code>day_open</code>: Date the casework is created by staff.</li>
<li><code>year_close</code>, <code>month_close</code>, <code>day_close</code>: Date the casework was closed.
<ul>
<li>A casework could be closed because the issue is resolved or because no further action could be taken.</li>
<li><code>NA</code> if the casework is not resolved.</li>
</ul></li>
<li><code>complaint_type</code>: Broader category designated by staff for the constituent casework.
<ul>
<li><code>complaint_type</code> corresponds to NYC Council Legislative Committees.</li>
</ul></li>
<li><code>descriptor</code>: Specific category designated by staff for the constituent casework.</li>
<li><code>zip</code>: Zip code of the constituent.</li>
<li><code>borough</code>: Borough of the constituent.</li>
<li><code>city</code>: City of the constituent.</li>
</ul>
<p><br></p>
</section>
<section id="q3a." class="level2">
<h2 class="anchored" data-anchor-id="q3a.">Q3a.</h2>
<ul>
<li>Calculate the number of observations for each <code>complaint_type</code>.</li>
<li>Find the top 10 most popular complaint types.</li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>NYComplaints <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(complaint_type) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 2
   complaint_type              n
   &lt;chr&gt;                   &lt;int&gt;
 1 Housing and Buildings   51541
 2 Transportation          30689
 3 Finance                 17862
 4 Immigration             12940
 5 General Welfare         10381
 6 Sanitation               8575
 7 Parks                    7573
 8 Public Safety            7277
 9 Environment              6601
10 Governmental Operations  5897
# ℹ 45 more rows</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="q3b." class="level2">
<h2 class="anchored" data-anchor-id="q3b.">Q3b.</h2>
<ul>
<li><p>Calculate the number of observations for each <code>complaint_type</code> for each <code>borough</code>.</p></li>
<li><p>Find the top 3 most popular complaint types for each <code>borough</code>.</p></li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>NYComplaints <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(borough, complaint_type) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> n, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 3
# Groups:   borough [6]
   borough       complaint_type            n
   &lt;chr&gt;         &lt;chr&gt;                 &lt;int&gt;
 1 Bronx         Housing and Buildings  4963
 2 Bronx         Finance                2559
 3 Bronx         Immigration            2286
 4 Brooklyn      Housing and Buildings 10915
 5 Brooklyn      Finance                6825
 6 Brooklyn      Transportation         6592
 7 Manhattan     Housing and Buildings 24574
 8 Manhattan     Transportation         4389
 9 Manhattan     General Welfare        2718
10 Queens        Transportation         7727
11 Queens        Housing and Buildings  6889
12 Queens        Finance                3402
13 Staten Island Transportation         9668
14 Staten Island Sanitation             2682
15 Staten Island Finance                2003
16 &lt;NA&gt;          Housing and Buildings  2431
17 &lt;NA&gt;          Immigration            2058
18 &lt;NA&gt;          Transportation         1601</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="q3c." class="level2">
<h2 class="anchored" data-anchor-id="q3c.">Q3c.</h2>
<ul>
<li><p>Provide both (1) a single ggplot and (2) a simple comment to describe the monthly trend of the proportion of resolved complaints for each borough.</p></li>
<li><p>The proportion of resolved complaints in one borough is defined as the number of resolved complaints in one borough divided by the number of all complaints in that borough.</p></li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>q3c <span class="ot">&lt;-</span> NYComplaints <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(borough)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">resolved =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(year_close), T, F) ) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(borough, resolved, year_open, month_open) <span class="sc">%&gt;%</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">opendate =</span> <span class="fu">make_date</span>(year_open, month_open)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(opendate, borough, resolved) <span class="sc">%&gt;%</span> </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>year_open, <span class="sc">-</span>month_open) <span class="sc">%&gt;%</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(tmp, borough, resolved) <span class="sc">%&gt;%</span> </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> tmp,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> n,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_Bronx =</span> <span class="dv">100</span> <span class="sc">*</span> Bronx_TRUE<span class="sc">/</span>(Bronx_TRUE <span class="sc">+</span> Bronx_FALSE),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_Brooklyn =</span> <span class="dv">100</span> <span class="sc">*</span> Brooklyn_TRUE<span class="sc">/</span>(Brooklyn_TRUE <span class="sc">+</span> Brooklyn_FALSE),</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_Manhattan =</span> <span class="dv">100</span> <span class="sc">*</span> Manhattan_TRUE<span class="sc">/</span>(Manhattan_TRUE <span class="sc">+</span> Manhattan_FALSE),</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_Queens =</span> <span class="dv">100</span> <span class="sc">*</span> Queens_TRUE<span class="sc">/</span>(Queens_TRUE <span class="sc">+</span> Queens_FALSE),</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_StatenIsland =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Staten Island_TRUE</span><span class="st">`</span><span class="sc">/</span>(<span class="st">`</span><span class="at">Staten Island_TRUE</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Staten Island_FALSE</span><span class="st">`</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(opendate, <span class="fu">starts_with</span>(<span class="st">"prop"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(prop_Bronx<span class="sc">:</span>prop_StatenIsland,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">'borough'</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">'prop'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">borough =</span> <span class="fu">str_replace</span>(borough, <span class="st">"prop_"</span>, <span class="st">""</span>))</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(q3c) <span class="sc">+</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> opendate, <span class="at">y =</span> prop, </span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="fu">fct_reorder2</span>(borough, opendate, prop)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="DANL200_final_2a_fall_2022_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script type="text/javascript" src="links.js"></script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb33" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Fall 2022 DANL 200 Final Exam 2"</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Byeong-Hak Choe"</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: true</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=F}</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_ipsum</span>())</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="fu"># Load R packages</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=F}</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 1</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>The following is the data.frame for Question 1.</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>NFL2022_stuffs <span class="ot">&lt;-</span> </span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"https://bcdanl.github.io/data/NFL2022_stuffs.csv"</span>)</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`NFL2022_stuffs`</span> is the data.frame that contains information about NFL games in year 2022, in which the unit of observation is a single play for each drive in a NFL game.</span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>cf) A drive in American football is a word used to describe what a team's offense does with the football while it is in their possession and the series of plays that follow their gaining possession of the ball. </span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variable description</span></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`play_id`</span>: Numeric play identifier that when used with <span class="in">`game_id`</span> and <span class="in">`drive`</span> provides the unique identifier for a single play</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`game_id`</span>: Ten digit identifier for NFL game.</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`drive`</span>: Numeric drive number in the game.</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`week`</span>: Season week.</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`posteam`</span>: String abbreviation for the team with possession.</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`qtr`</span>: Quarter of the game (5 is overtime).</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`half_seconds_remaining`</span>: Numeric seconds remaining in the half.</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`down`</span>: The down for the given play.</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Basically you get four attempts (a.k.a. downs) to move the ball 10 yards (by either running with it or passing it). </span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>If you make 10 yards then you get another set of four downs.</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`pass`</span>: Binary indicator if the play was a pass play.</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`wp`</span>: Estimated winning probability for the <span class="in">`posteam`</span> given the current situation at the start of the given play.</span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q1a.</span></span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>In data.frame, <span class="in">`NFL2022_stuffs`</span>, remove observations for which values of <span class="in">`posteam`</span> is missing.</span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>q1a <span class="ot">&lt;-</span> NFL2022_stuffs <span class="sc">%&gt;%</span> </span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(posteam))</span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q1b.</span></span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Summarize the mean value of <span class="in">`pass`</span> for each <span class="in">`posteam`</span> when all the following conditions hold:</span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(1) <span class="in">`wp`</span> is greater than 20% and less than 75%;</span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(2) <span class="in">`down`</span> is less than or equal to 2; and</span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(3) <span class="in">`half_seconds_remaining`</span> is greater than 120.</span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a>q1b <span class="ot">&lt;-</span> q1a <span class="sc">%&gt;%</span></span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wp <span class="sc">&gt;</span> .<span class="dv">20</span>, wp <span class="sc">&lt;</span> .<span class="dv">75</span>, down <span class="sc">&lt;=</span> <span class="dv">2</span>, qtr <span class="sc">&lt;=</span> <span class="dv">2</span>, </span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a>         half_seconds_remaining <span class="sc">&gt;</span> <span class="dv">120</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(posteam) <span class="sc">%&gt;%</span></span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_pass =</span> <span class="fu">mean</span>(pass), </span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a>            <span class="at">plays =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(mean_pass)</span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q1c.</span></span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Provide both (1) a ggplot code with <span class="in">`geom_point()`</span> using the resulting data.frame in Q1b and (2) a simple comments to describe the mean value of <span class="in">`pass`</span> for each <span class="in">`posteam`</span>.</span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In the ggplot, reorder the <span class="in">`posteam`</span> categories based on the mean value of <span class="in">`pass`</span> in ascending or in descending order.</span>
<span id="cb33-105"><a href="#cb33-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-108"><a href="#cb33-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-109"><a href="#cb33-109" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> q1b,</span>
<span id="cb33-110"><a href="#cb33-110" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>( <span class="at">x =</span> <span class="fu">reorder</span>(posteam,<span class="sc">-</span>mean_pass), </span>
<span id="cb33-111"><a href="#cb33-111" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> mean_pass)) <span class="sc">+</span></span>
<span id="cb33-112"><a href="#cb33-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-113"><a href="#cb33-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb33-114"><a href="#cb33-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-115"><a href="#cb33-115" aria-hidden="true" tabindex="-1"></a>Comments are not provided here.</span>
<span id="cb33-116"><a href="#cb33-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-117"><a href="#cb33-117" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-118"><a href="#cb33-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-119"><a href="#cb33-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q1d.</span></span>
<span id="cb33-120"><a href="#cb33-120" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Download the CSV file, NFL2022_epa.csv.</span>
<span id="cb33-121"><a href="#cb33-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-122"><a href="#cb33-122" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Variable description for NFL2022_epa.csv </span>
<span id="cb33-123"><a href="#cb33-123" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`play_id`</span>: Numeric play identifier that when used with <span class="in">`game_id`</span> and <span class="in">`drive`</span> provides the unique identifier for a single play</span>
<span id="cb33-124"><a href="#cb33-124" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`game_id`</span>: Ten digit identifier for NFL game.</span>
<span id="cb33-125"><a href="#cb33-125" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`drive`</span>: Numeric drive number in the game.</span>
<span id="cb33-126"><a href="#cb33-126" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`posteam`</span>: String abbreviation for the team with possession.</span>
<span id="cb33-127"><a href="#cb33-127" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`passer`</span>: Name of the player who passed a ball to a receiver by initially taking a three-step drop, backpedaling into the pocket to make a pass. (Mostly, the quarterbacks)</span>
<span id="cb33-128"><a href="#cb33-128" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`receiver`</span>: Name of the receiver.</span>
<span id="cb33-129"><a href="#cb33-129" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`epa`</span>: Expected points added (EPA) by the posteam for the given play.</span>
<span id="cb33-130"><a href="#cb33-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-131"><a href="#cb33-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-132"><a href="#cb33-132" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Read the CSV file, <span class="in">`NFL2022_epa.csv`</span>, as data.frame with the name, <span class="in">`NFL2022_epa`</span>.</span>
<span id="cb33-133"><a href="#cb33-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-134"><a href="#cb33-134" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Then, create the data.frame, <span class="in">`NFL2022_stuffs_EPA`</span>, that includes </span>
<span id="cb33-135"><a href="#cb33-135" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(1) all the variables in the data.frame, <span class="in">`NFL2022_stuffs`</span>, and</span>
<span id="cb33-136"><a href="#cb33-136" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(2) <span class="in">`passer`</span>, <span class="in">`receiver`</span>, and <span class="in">`epa`</span> in the data.frame, <span class="in">`NFL2022_epa`</span></span>
<span id="cb33-137"><a href="#cb33-137" aria-hidden="true" tabindex="-1"></a>by joining the two data.frames.</span>
<span id="cb33-138"><a href="#cb33-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-139"><a href="#cb33-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-142"><a href="#cb33-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-143"><a href="#cb33-143" aria-hidden="true" tabindex="-1"></a>NFL2022_epa <span class="ot">&lt;-</span> </span>
<span id="cb33-144"><a href="#cb33-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"/Users/byeong-hakchoe/Google Drive/suny-geneseo/teaching-materials/lecture-data/NFL2022_epa.csv"</span>)</span>
<span id="cb33-145"><a href="#cb33-145" aria-hidden="true" tabindex="-1"></a>q1d <span class="ot">&lt;-</span> NFL2022_stuffs <span class="sc">%&gt;%</span> </span>
<span id="cb33-146"><a href="#cb33-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(NFL2022_epa) <span class="sc">%&gt;%</span> </span>
<span id="cb33-147"><a href="#cb33-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(passer))</span>
<span id="cb33-148"><a href="#cb33-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-149"><a href="#cb33-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-150"><a href="#cb33-150" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-151"><a href="#cb33-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-152"><a href="#cb33-152" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q1e.</span></span>
<span id="cb33-153"><a href="#cb33-153" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Provide both (1) a single ggplot and (2) a simple comment to describe the NFL weekly trend of <span class="in">`week`</span>ly mean value of <span class="in">`epa`</span> for each of passers, (a) <span class="in">`passer == "J.Allen"`</span> and (b) <span class="in">`passer == "P.Mahomes"`</span>.</span>
<span id="cb33-154"><a href="#cb33-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-157"><a href="#cb33-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-158"><a href="#cb33-158" aria-hidden="true" tabindex="-1"></a>q1e <span class="ot">&lt;-</span> q1d <span class="sc">%&gt;%</span></span>
<span id="cb33-159"><a href="#cb33-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( <span class="fu">str_detect</span>(passer, <span class="st">"J.Allen"</span>) <span class="sc">|</span> </span>
<span id="cb33-160"><a href="#cb33-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_detect</span>(passer, <span class="st">"P.Mahomes"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb33-161"><a href="#cb33-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(week, passer) <span class="sc">%&gt;%</span> </span>
<span id="cb33-162"><a href="#cb33-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_epa =</span> <span class="fu">mean</span>(epa, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb33-163"><a href="#cb33-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-164"><a href="#cb33-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-165"><a href="#cb33-165" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( q1e, </span>
<span id="cb33-166"><a href="#cb33-166" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> mean_epa, <span class="at">color =</span> passer) ) <span class="sc">+</span></span>
<span id="cb33-167"><a href="#cb33-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb33-168"><a href="#cb33-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-169"><a href="#cb33-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-170"><a href="#cb33-170" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-171"><a href="#cb33-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-172"><a href="#cb33-172" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q1f.</span></span>
<span id="cb33-173"><a href="#cb33-173" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate the difference between the mean value of <span class="in">`epa`</span> for <span class="in">`passer == "J.Allen"`</span> the mean value of <span class="in">`epa`</span> for <span class="in">`passer == "P.Mahomes"`</span> for each value of <span class="in">`week`</span>.</span>
<span id="cb33-174"><a href="#cb33-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-177"><a href="#cb33-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-178"><a href="#cb33-178" aria-hidden="true" tabindex="-1"></a>q1f <span class="ot">&lt;-</span> q1e <span class="sc">%&gt;%</span> </span>
<span id="cb33-179"><a href="#cb33-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> mean_epa,</span>
<span id="cb33-180"><a href="#cb33-180" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> passer) <span class="sc">%&gt;%</span> </span>
<span id="cb33-181"><a href="#cb33-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_epa =</span> J.Allen <span class="sc">-</span> P.Mahomes)</span>
<span id="cb33-182"><a href="#cb33-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-183"><a href="#cb33-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-184"><a href="#cb33-184" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-185"><a href="#cb33-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-186"><a href="#cb33-186" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q1g.</span></span>
<span id="cb33-187"><a href="#cb33-187" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Summarize the resulting data.frame in Q1d, with the following four variables:</span>
<span id="cb33-188"><a href="#cb33-188" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`posteam`</span>: String abbreviation for the team with possession.</span>
<span id="cb33-189"><a href="#cb33-189" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`passer`</span>: Name of the player who passed a ball to a receiver by initially taking a three-step drop, backpedaling into the pocket to make a pass. (Mostly, the quarterbacks)</span>
<span id="cb33-190"><a href="#cb33-190" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`mean_epa`</span>: Mean value of epa in 2022 for each passer</span>
<span id="cb33-191"><a href="#cb33-191" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`n_pass`</span>: Number of observations for each passer</span>
<span id="cb33-192"><a href="#cb33-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-193"><a href="#cb33-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-194"><a href="#cb33-194" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Then find the top 10 NFL passers in 2022 in terms of the mean value of <span class="in">`epa`</span>, conditioning that <span class="in">`n_pass`</span> must be greater than or equal to the third quartile level of <span class="in">`n_pass`</span>.</span>
<span id="cb33-195"><a href="#cb33-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-198"><a href="#cb33-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-199"><a href="#cb33-199" aria-hidden="true" tabindex="-1"></a>q1g <span class="ot">&lt;-</span> q1d <span class="sc">%&gt;%</span></span>
<span id="cb33-200"><a href="#cb33-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(posteam, passer) <span class="sc">%&gt;%</span> </span>
<span id="cb33-201"><a href="#cb33-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_epa =</span> <span class="fu">mean</span>(epa, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-202"><a href="#cb33-202" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb33-203"><a href="#cb33-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb33-204"><a href="#cb33-204" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(q1g) <span class="co"># to see the third quartile</span></span>
<span id="cb33-205"><a href="#cb33-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-206"><a href="#cb33-206" aria-hidden="true" tabindex="-1"></a>q1g <span class="ot">&lt;-</span> q1g <span class="sc">%&gt;%</span> </span>
<span id="cb33-207"><a href="#cb33-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">355</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-208"><a href="#cb33-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>mean_epa)</span>
<span id="cb33-209"><a href="#cb33-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-210"><a href="#cb33-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-211"><a href="#cb33-211" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;&lt;br&gt;</span></span>
<span id="cb33-212"><a href="#cb33-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-213"><a href="#cb33-213" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 2</span></span>
<span id="cb33-214"><a href="#cb33-214" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The following is the description for Question 2:</span>
<span id="cb33-215"><a href="#cb33-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-216"><a href="#cb33-216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The income tax exemption scheme for pension savings is a system that reduces an income tax burden, so that individuals can build up more personal pensions to help them ensure their well-being in old age.</span>
<span id="cb33-217"><a href="#cb33-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-218"><a href="#cb33-218" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In particular, from 2005 to 2006, the tax authority expanded the limit amount of income tax exemption for pension savings from \$2,000 to \$3,000. </span>
<span id="cb33-219"><a href="#cb33-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-220"><a href="#cb33-220" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>That is to say, pension savings were exempt from income tax up to \$2,000 in 2005, and increased to \$3,000 for the 2006 tax year.</span>
<span id="cb33-221"><a href="#cb33-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-222"><a href="#cb33-222" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The following data.frame comes from the Census and the tax authority, and covers households in years 2005-2006:</span>
<span id="cb33-225"><a href="#cb33-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-226"><a href="#cb33-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb33-227"><a href="#cb33-227" aria-hidden="true" tabindex="-1"></a>pension_tax <span class="ot">&lt;-</span> </span>
<span id="cb33-228"><a href="#cb33-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"https://bcdanl.github.io/data/pension_tax_cleaned.csv"</span>)</span>
<span id="cb33-229"><a href="#cb33-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-230"><a href="#cb33-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-231"><a href="#cb33-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-232"><a href="#cb33-232" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variable description</span></span>
<span id="cb33-233"><a href="#cb33-233" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`hh_id`</span>: Household Identification (ID) number.</span>
<span id="cb33-234"><a href="#cb33-234" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`gender`</span>: Gender (Female or Male).</span>
<span id="cb33-235"><a href="#cb33-235" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`schooling`</span>: Level of educational attainment.</span>
<span id="cb33-236"><a href="#cb33-236" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`region`</span>: City-level geographic region.</span>
<span id="cb33-237"><a href="#cb33-237" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`year`</span>: Year (2005 or 2006).</span>
<span id="cb33-238"><a href="#cb33-238" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`pension_saving`</span>: Amount of yearly pension saving  (in $).</span>
<span id="cb33-239"><a href="#cb33-239" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`saving3000below`</span>: TRUE if <span class="in">`pension_saving`</span> in 2005 is less than $3,000; <span class="in">`FALSE`</span> otherwise.</span>
<span id="cb33-240"><a href="#cb33-240" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`family_size`</span>: Family size (non-negative integer values).</span>
<span id="cb33-241"><a href="#cb33-241" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`net_asset`</span>: Net asset (in $1,000).</span>
<span id="cb33-242"><a href="#cb33-242" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`public_pension`</span>: <span class="in">`TRUE`</span> if the type of pension is public; <span class="in">`FALSE`</span> otherwise.</span>
<span id="cb33-243"><a href="#cb33-243" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`home_owner`</span>: <span class="in">`TRUE`</span> if household owns a house; <span class="in">`FALSE`</span> otherwise.</span>
<span id="cb33-244"><a href="#cb33-244" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`age`</span>: Age of the household member who is a main income contributor.</span>
<span id="cb33-245"><a href="#cb33-245" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`age_sq`</span>: Age squared.</span>
<span id="cb33-246"><a href="#cb33-246" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`hh_expenditure`</span>: Household expenditure.</span>
<span id="cb33-247"><a href="#cb33-247" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`hh_income`</span>: Household income.</span>
<span id="cb33-248"><a href="#cb33-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-249"><a href="#cb33-249" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-250"><a href="#cb33-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-251"><a href="#cb33-251" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q2a.</span></span>
<span id="cb33-252"><a href="#cb33-252" aria-hidden="true" tabindex="-1"></a>Report (1) minimum, (2) median, (3) maximum, (4) mean, and (5) standard deviation of variable <span class="in">`pension_saving`</span> for New York, NY.</span>
<span id="cb33-253"><a href="#cb33-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-256"><a href="#cb33-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-257"><a href="#cb33-257" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pension_tax<span class="sc">$</span>region)</span>
<span id="cb33-258"><a href="#cb33-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-259"><a href="#cb33-259" aria-hidden="true" tabindex="-1"></a>pension_tax <span class="sc">%&gt;%</span> </span>
<span id="cb33-260"><a href="#cb33-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"New York, NY"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-261"><a href="#cb33-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">skim</span>(pension_saving)</span>
<span id="cb33-262"><a href="#cb33-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-263"><a href="#cb33-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-264"><a href="#cb33-264" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-265"><a href="#cb33-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-266"><a href="#cb33-266" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q2b.</span></span>
<span id="cb33-267"><a href="#cb33-267" aria-hidden="true" tabindex="-1"></a>Using the given data.frame, <span class="in">`pension_tax`</span>, create the data.frame, <span class="in">`pension_tax`</span>, for which</span>
<span id="cb33-268"><a href="#cb33-268" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(1) <span class="in">`year`</span> is a factor-type variable of <span class="in">`year`</span> with a reference level, 2005.</span>
<span id="cb33-269"><a href="#cb33-269" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(2) <span class="in">`schooling`</span> is a factor-type variable of <span class="in">`schooling`</span> with the following order of levels, defined in the <span class="in">`educ`</span> vector:</span>
<span id="cb33-270"><a href="#cb33-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-273"><a href="#cb33-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-274"><a href="#cb33-274" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb33-275"><a href="#cb33-275" aria-hidden="true" tabindex="-1"></a>educ <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"Bachelor's Degree"</span>, </span>
<span id="cb33-276"><a href="#cb33-276" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Elementary School"</span>, </span>
<span id="cb33-277"><a href="#cb33-277" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Middle School"</span>,</span>
<span id="cb33-278"><a href="#cb33-278" aria-hidden="true" tabindex="-1"></a>           <span class="st">"High School Diploma"</span>, </span>
<span id="cb33-279"><a href="#cb33-279" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Associate's Degree"</span>, </span>
<span id="cb33-280"><a href="#cb33-280" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Master's Degree"</span>, </span>
<span id="cb33-281"><a href="#cb33-281" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Ph.D. Degree"</span> )</span>
<span id="cb33-282"><a href="#cb33-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-283"><a href="#cb33-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-284"><a href="#cb33-284" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Answer</span>
<span id="cb33-287"><a href="#cb33-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-288"><a href="#cb33-288" aria-hidden="true" tabindex="-1"></a>pension_tax <span class="ot">&lt;-</span> pension_tax <span class="sc">%&gt;%</span> </span>
<span id="cb33-289"><a href="#cb33-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">year =</span> <span class="fu">factor</span>(year, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2005</span>, <span class="dv">2006</span>) ),</span>
<span id="cb33-290"><a href="#cb33-290" aria-hidden="true" tabindex="-1"></a>          <span class="at">schooling =</span> <span class="fu">factor</span>(schooling, <span class="at">levels =</span> educ )</span>
<span id="cb33-291"><a href="#cb33-291" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-292"><a href="#cb33-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-293"><a href="#cb33-293" aria-hidden="true" tabindex="-1"></a><span class="co"># levels(pension_tax$year)</span></span>
<span id="cb33-294"><a href="#cb33-294" aria-hidden="true" tabindex="-1"></a><span class="co"># levels(pension_tax$schooling)</span></span>
<span id="cb33-295"><a href="#cb33-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-296"><a href="#cb33-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-297"><a href="#cb33-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-298"><a href="#cb33-298" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-299"><a href="#cb33-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-300"><a href="#cb33-300" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q2c.</span></span>
<span id="cb33-301"><a href="#cb33-301" aria-hidden="true" tabindex="-1"></a>Provide both (1) ggplot and (2) simple comments to describe the trend for the mean value of <span class="in">`log(pension_saving)`</span> for each group of <span class="in">`saving3000below`</span>.</span>
<span id="cb33-304"><a href="#cb33-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-305"><a href="#cb33-305" aria-hidden="true" tabindex="-1"></a>q2c <span class="ot">&lt;-</span> pension_tax <span class="sc">%&gt;%</span> </span>
<span id="cb33-306"><a href="#cb33-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, saving3000below) <span class="sc">%&gt;%</span> </span>
<span id="cb33-307"><a href="#cb33-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>( <span class="at">mean_log_pension_saving =</span> <span class="fu">mean</span>( <span class="fu">log</span>(pension_saving) ) )</span>
<span id="cb33-308"><a href="#cb33-308" aria-hidden="true" tabindex="-1"></a>q2c</span>
<span id="cb33-309"><a href="#cb33-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-310"><a href="#cb33-310" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> q2c,</span>
<span id="cb33-311"><a href="#cb33-311" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> mean_log_pension_saving,</span>
<span id="cb33-312"><a href="#cb33-312" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> saving3000below, <span class="at">color =</span> saving3000below) ) <span class="sc">+</span></span>
<span id="cb33-313"><a href="#cb33-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">lty =</span> saving3000below)  ) <span class="sc">+</span></span>
<span id="cb33-314"><a href="#cb33-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb33-315"><a href="#cb33-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-316"><a href="#cb33-316" aria-hidden="true" tabindex="-1"></a>Comments are not provided here.</span>
<span id="cb33-317"><a href="#cb33-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-318"><a href="#cb33-318" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-319"><a href="#cb33-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-320"><a href="#cb33-320" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q2d.</span></span>
<span id="cb33-321"><a href="#cb33-321" aria-hidden="true" tabindex="-1"></a>Provide both (1) ggplot and (2) simple comments to describe the trend for the distribution of <span class="in">`log(pension_saving)`</span> for each group of <span class="in">`saving3000below`</span>.</span>
<span id="cb33-322"><a href="#cb33-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-325"><a href="#cb33-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-326"><a href="#cb33-326" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pension_tax,</span>
<span id="cb33-327"><a href="#cb33-327" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year), <span class="at">y =</span> <span class="fu">log</span>(pension_saving))) <span class="sc">+</span></span>
<span id="cb33-328"><a href="#cb33-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( <span class="fu">aes</span>(<span class="at">fill =</span> saving3000below ),</span>
<span id="cb33-329"><a href="#cb33-329" aria-hidden="true" tabindex="-1"></a>                <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>) ) <span class="sc">+</span></span>
<span id="cb33-330"><a href="#cb33-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>( <span class="fu">aes</span>( <span class="at">group =</span> saving3000below ),</span>
<span id="cb33-331"><a href="#cb33-331" aria-hidden="true" tabindex="-1"></a>                <span class="at">fun =</span> mean,</span>
<span id="cb33-332"><a href="#cb33-332" aria-hidden="true" tabindex="-1"></a>                <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb33-333"><a href="#cb33-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> q2c,</span>
<span id="cb33-334"><a href="#cb33-334" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year), <span class="at">y =</span> mean_log_pension_saving,</span>
<span id="cb33-335"><a href="#cb33-335" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> saving3000below, <span class="at">color =</span> saving3000below,</span>
<span id="cb33-336"><a href="#cb33-336" aria-hidden="true" tabindex="-1"></a>                <span class="at">lty =</span> saving3000below),</span>
<span id="cb33-337"><a href="#cb33-337" aria-hidden="true" tabindex="-1"></a>            <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>) )</span>
<span id="cb33-338"><a href="#cb33-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-339"><a href="#cb33-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-340"><a href="#cb33-340" aria-hidden="true" tabindex="-1"></a>Comments are not provided here.</span>
<span id="cb33-341"><a href="#cb33-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-342"><a href="#cb33-342" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-343"><a href="#cb33-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-344"><a href="#cb33-344" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q2e.</span></span>
<span id="cb33-345"><a href="#cb33-345" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Remove the observations in the data.frame, pension_tax, if the number of observations for each <span class="in">`hh_id`</span> is 1.</span>
<span id="cb33-346"><a href="#cb33-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-347"><a href="#cb33-347" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Then, randomly split the data.frame, pension_tax, into training and testing data.frames.</span>
<span id="cb33-348"><a href="#cb33-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-349"><a href="#cb33-349" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Approximately 75% of observations in the data.frame, pension_tax, must go to the training data.frame. </span>
<span id="cb33-350"><a href="#cb33-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-351"><a href="#cb33-351" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The rest observations in the the data.frame, pension_tax, must go to the testing data.frame.</span>
<span id="cb33-352"><a href="#cb33-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-353"><a href="#cb33-353" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Additionally, in both training and testing data.frames, </span>
<span id="cb33-354"><a href="#cb33-354" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(1) the number of observations for each <span class="in">`hh_id`</span> must be 2.</span>
<span id="cb33-355"><a href="#cb33-355" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(2) the fraction of observations with <span class="in">`saving3000below`</span> == TRUE must be approximately 75%.</span>
<span id="cb33-356"><a href="#cb33-356" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(3) the fraction of observations with <span class="in">`saving3000below`</span> == FALSE must be approximately 25%.</span>
<span id="cb33-357"><a href="#cb33-357" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-360"><a href="#cb33-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-361"><a href="#cb33-361" aria-hidden="true" tabindex="-1"></a>q1c <span class="ot">&lt;-</span> pension_tax <span class="sc">%&gt;%</span> </span>
<span id="cb33-362"><a href="#cb33-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hh_id) <span class="sc">%&gt;%</span> </span>
<span id="cb33-363"><a href="#cb33-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="fu">n</span>() ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-364"><a href="#cb33-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( n <span class="sc">==</span> <span class="dv">2</span> )</span>
<span id="cb33-365"><a href="#cb33-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-366"><a href="#cb33-366" aria-hidden="true" tabindex="-1"></a>q1c_T <span class="ot">&lt;-</span> q1c <span class="sc">%&gt;%</span> </span>
<span id="cb33-367"><a href="#cb33-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( saving3000below <span class="sc">==</span> T )<span class="sc">%&gt;%</span>  <span class="co"># 214</span></span>
<span id="cb33-368"><a href="#cb33-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hh_id) <span class="sc">%&gt;%</span> </span>
<span id="cb33-369"><a href="#cb33-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="fu">n</span>() ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-370"><a href="#cb33-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( n <span class="sc">==</span> <span class="dv">2</span> ) <span class="sc">%&gt;%</span>  <span class="co"># 214</span></span>
<span id="cb33-371"><a href="#cb33-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb33-372"><a href="#cb33-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-373"><a href="#cb33-373" aria-hidden="true" tabindex="-1"></a>q1c_F <span class="ot">&lt;-</span> q1c <span class="sc">%&gt;%</span> </span>
<span id="cb33-374"><a href="#cb33-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( saving3000below <span class="sc">==</span> F )<span class="sc">%&gt;%</span> <span class="co"># 82</span></span>
<span id="cb33-375"><a href="#cb33-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hh_id) <span class="sc">%&gt;%</span> </span>
<span id="cb33-376"><a href="#cb33-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="fu">n</span>() ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-377"><a href="#cb33-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( n <span class="sc">==</span> <span class="dv">2</span> ) <span class="sc">%&gt;%</span>  <span class="co"># 82</span></span>
<span id="cb33-378"><a href="#cb33-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb33-379"><a href="#cb33-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-380"><a href="#cb33-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-381"><a href="#cb33-381" aria-hidden="true" tabindex="-1"></a>q1c_T_05 <span class="ot">&lt;-</span> q1c_T <span class="sc">%&gt;%</span> </span>
<span id="cb33-382"><a href="#cb33-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( year <span class="sc">==</span> <span class="dv">2005</span> )</span>
<span id="cb33-383"><a href="#cb33-383" aria-hidden="true" tabindex="-1"></a>q1c_T_06 <span class="ot">&lt;-</span> q1c_T <span class="sc">%&gt;%</span> </span>
<span id="cb33-384"><a href="#cb33-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( year <span class="sc">==</span> <span class="dv">2006</span> )</span>
<span id="cb33-385"><a href="#cb33-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-386"><a href="#cb33-386" aria-hidden="true" tabindex="-1"></a>q1c_F_05 <span class="ot">&lt;-</span> q1c_F <span class="sc">%&gt;%</span> </span>
<span id="cb33-387"><a href="#cb33-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( year <span class="sc">==</span> <span class="dv">2005</span> )</span>
<span id="cb33-388"><a href="#cb33-388" aria-hidden="true" tabindex="-1"></a>q1c_F_06 <span class="ot">&lt;-</span> q1c_F <span class="sc">%&gt;%</span> </span>
<span id="cb33-389"><a href="#cb33-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( year <span class="sc">==</span> <span class="dv">2006</span> )</span>
<span id="cb33-390"><a href="#cb33-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-391"><a href="#cb33-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-392"><a href="#cb33-392" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb33-393"><a href="#cb33-393" aria-hidden="true" tabindex="-1"></a>gp_T <span class="ot">&lt;-</span> <span class="fu">runif</span>( <span class="fu">nrow</span>(q1c_T_05)) </span>
<span id="cb33-394"><a href="#cb33-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-395"><a href="#cb33-395" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb33-396"><a href="#cb33-396" aria-hidden="true" tabindex="-1"></a>gp_F <span class="ot">&lt;-</span> <span class="fu">runif</span>( <span class="fu">nrow</span>(q1c_F_05) )</span>
<span id="cb33-397"><a href="#cb33-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-398"><a href="#cb33-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-399"><a href="#cb33-399" aria-hidden="true" tabindex="-1"></a>q1c_T_05_train <span class="ot">&lt;-</span> q1c_T_05 <span class="sc">%&gt;%</span> </span>
<span id="cb33-400"><a href="#cb33-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_T <span class="sc">&gt;</span> .<span class="dv">25</span>)</span>
<span id="cb33-401"><a href="#cb33-401" aria-hidden="true" tabindex="-1"></a>q1c_T_06_train <span class="ot">&lt;-</span> q1c_T_06 <span class="sc">%&gt;%</span> </span>
<span id="cb33-402"><a href="#cb33-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_T <span class="sc">&gt;</span> .<span class="dv">25</span>)</span>
<span id="cb33-403"><a href="#cb33-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-404"><a href="#cb33-404" aria-hidden="true" tabindex="-1"></a>q1c_F_05_train <span class="ot">&lt;-</span> q1c_F_05 <span class="sc">%&gt;%</span> </span>
<span id="cb33-405"><a href="#cb33-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_F <span class="sc">&gt;</span> .<span class="dv">25</span>)</span>
<span id="cb33-406"><a href="#cb33-406" aria-hidden="true" tabindex="-1"></a>q1c_F_06_train <span class="ot">&lt;-</span> q1c_F_06 <span class="sc">%&gt;%</span> </span>
<span id="cb33-407"><a href="#cb33-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_F <span class="sc">&gt;</span> .<span class="dv">25</span>)</span>
<span id="cb33-408"><a href="#cb33-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-409"><a href="#cb33-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-410"><a href="#cb33-410" aria-hidden="true" tabindex="-1"></a>q1c_T_05_test <span class="ot">&lt;-</span> q1c_T_05 <span class="sc">%&gt;%</span> </span>
<span id="cb33-411"><a href="#cb33-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_T <span class="sc">&lt;=</span> .<span class="dv">25</span>)</span>
<span id="cb33-412"><a href="#cb33-412" aria-hidden="true" tabindex="-1"></a>q1c_T_06_test <span class="ot">&lt;-</span> q1c_T_06 <span class="sc">%&gt;%</span> </span>
<span id="cb33-413"><a href="#cb33-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_T <span class="sc">&lt;=</span> .<span class="dv">25</span>)</span>
<span id="cb33-414"><a href="#cb33-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-415"><a href="#cb33-415" aria-hidden="true" tabindex="-1"></a>q1c_F_05_test <span class="ot">&lt;-</span> q1c_F_05 <span class="sc">%&gt;%</span> </span>
<span id="cb33-416"><a href="#cb33-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_F <span class="sc">&lt;=</span> .<span class="dv">25</span>)</span>
<span id="cb33-417"><a href="#cb33-417" aria-hidden="true" tabindex="-1"></a>q1c_F_06_test <span class="ot">&lt;-</span> q1c_F_06 <span class="sc">%&gt;%</span> </span>
<span id="cb33-418"><a href="#cb33-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gp_F <span class="sc">&lt;=</span> .<span class="dv">25</span>)</span>
<span id="cb33-419"><a href="#cb33-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-420"><a href="#cb33-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-421"><a href="#cb33-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-422"><a href="#cb33-422" aria-hidden="true" tabindex="-1"></a>dtrain <span class="ot">&lt;-</span> <span class="fu">rbind</span>(q1c_T_05_train, q1c_T_06_train,</span>
<span id="cb33-423"><a href="#cb33-423" aria-hidden="true" tabindex="-1"></a>                q1c_F_05_train, q1c_F_06_train) <span class="sc">%&gt;%</span> </span>
<span id="cb33-424"><a href="#cb33-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(hh_id, year)</span>
<span id="cb33-425"><a href="#cb33-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-426"><a href="#cb33-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-427"><a href="#cb33-427" aria-hidden="true" tabindex="-1"></a>dtest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(q1c_T_05_test, q1c_T_06_test,</span>
<span id="cb33-428"><a href="#cb33-428" aria-hidden="true" tabindex="-1"></a>               q1c_F_05_test, q1c_F_06_test) <span class="sc">%&gt;%</span> </span>
<span id="cb33-429"><a href="#cb33-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(hh_id, year)</span>
<span id="cb33-430"><a href="#cb33-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-431"><a href="#cb33-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-432"><a href="#cb33-432" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>( dtrain <span class="sc">%&gt;%</span> <span class="fu">count</span>(hh_id) <span class="sc">%&gt;%</span> <span class="fu">select</span>(n) )</span>
<span id="cb33-433"><a href="#cb33-433" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>( dtest <span class="sc">%&gt;%</span> <span class="fu">count</span>(hh_id) <span class="sc">%&gt;%</span> <span class="fu">select</span>(n) )</span>
<span id="cb33-434"><a href="#cb33-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-435"><a href="#cb33-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-436"><a href="#cb33-436" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-437"><a href="#cb33-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-438"><a href="#cb33-438" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q2f.</span></span>
<span id="cb33-439"><a href="#cb33-439" aria-hidden="true" tabindex="-1"></a>Consider the following formula for linear regression:</span>
<span id="cb33-442"><a href="#cb33-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-443"><a href="#cb33-443" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb33-444"><a href="#cb33-444" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="fu">log</span>(pension_saving) <span class="sc">~</span> </span>
<span id="cb33-445"><a href="#cb33-445" aria-hidden="true" tabindex="-1"></a>  saving3000below <span class="sc">*</span> year <span class="sc">+</span> </span>
<span id="cb33-446"><a href="#cb33-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(hh_income) <span class="sc">+</span> <span class="fu">log</span>(hh_expenditure) <span class="sc">+</span></span>
<span id="cb33-447"><a href="#cb33-447" aria-hidden="true" tabindex="-1"></a>  family_size <span class="sc">+</span> net_asset <span class="sc">+</span> schooling <span class="sc">+</span></span>
<span id="cb33-448"><a href="#cb33-448" aria-hidden="true" tabindex="-1"></a>  gender <span class="sc">+</span> age <span class="sc">+</span> age_sq <span class="sc">+</span> public_pension</span>
<span id="cb33-449"><a href="#cb33-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-450"><a href="#cb33-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-451"><a href="#cb33-451" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Train the linear regression model with the above formula.</span>
<span id="cb33-452"><a href="#cb33-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-453"><a href="#cb33-453" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If you could not properly split the data.frame into the training  and testing data.frames in Q2e, use the data.frame, <span class="in">`pension_tax`</span>, as the training data.frame.</span>
<span id="cb33-454"><a href="#cb33-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-455"><a href="#cb33-455" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report the summary of the linear regression result.</span>
<span id="cb33-456"><a href="#cb33-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-459"><a href="#cb33-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-460"><a href="#cb33-460" aria-hidden="true" tabindex="-1"></a>dtrain <span class="ot">&lt;-</span> dtrain <span class="sc">%&gt;%</span> </span>
<span id="cb33-461"><a href="#cb33-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">net_asset =</span> net_asset <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb33-462"><a href="#cb33-462" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>( formula, </span>
<span id="cb33-463"><a href="#cb33-463" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> dtrain )</span>
<span id="cb33-464"><a href="#cb33-464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-465"><a href="#cb33-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-466"><a href="#cb33-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-467"><a href="#cb33-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = F}</span></span>
<span id="cb33-468"><a href="#cb33-468" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(model, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb33-469"><a href="#cb33-469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-470"><a href="#cb33-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-471"><a href="#cb33-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-472"><a href="#cb33-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = F, results='asis'}</span></span>
<span id="cb33-473"><a href="#cb33-473" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(model, <span class="at">type =</span> <span class="st">'html'</span>)</span>
<span id="cb33-474"><a href="#cb33-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-475"><a href="#cb33-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-476"><a href="#cb33-476" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-477"><a href="#cb33-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-478"><a href="#cb33-478" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q2g. </span></span>
<span id="cb33-479"><a href="#cb33-479" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Visualize the confidence intervals of all the beta estimates except for the variables <span class="in">`(Intercept)`</span> and <span class="in">`saving3000below`</span>.</span>
<span id="cb33-480"><a href="#cb33-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-481"><a href="#cb33-481" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What does it mean that a confidence interval of a beta estimate contains a zero level of its beta estimate?</span>
<span id="cb33-482"><a href="#cb33-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-485"><a href="#cb33-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-486"><a href="#cb33-486" aria-hidden="true" tabindex="-1"></a>sum_model <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb33-487"><a href="#cb33-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>, term <span class="sc">!=</span> <span class="st">"saving3000belowTRUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-488"><a href="#cb33-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">star =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;=</span> .<span class="dv">1</span>, T, F)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-489"><a href="#cb33-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(star, <span class="fu">everything</span>())</span>
<span id="cb33-490"><a href="#cb33-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-491"><a href="#cb33-491" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sum_model) <span class="sc">+</span></span>
<span id="cb33-492"><a href="#cb33-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>( <span class="fu">aes</span>(<span class="at">x =</span> term, </span>
<span id="cb33-493"><a href="#cb33-493" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> estimate,</span>
<span id="cb33-494"><a href="#cb33-494" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ymin =</span> estimate <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>std.error,</span>
<span id="cb33-495"><a href="#cb33-495" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ymax =</span> estimate <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>std.error ) ) <span class="sc">+</span></span>
<span id="cb33-496"><a href="#cb33-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb33-497"><a href="#cb33-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb33-498"><a href="#cb33-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-499"><a href="#cb33-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-500"><a href="#cb33-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-501"><a href="#cb33-501" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If <span class="in">`estimate == 0`</span> belongs to a confidence interval of the beta estimate, the beta estimate may not be statistically different from zero, and there is insufficient evidence to conclude that there is a non-zero relationship between the explanatory variable and the outcome variable.</span>
<span id="cb33-502"><a href="#cb33-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-503"><a href="#cb33-503" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-504"><a href="#cb33-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-505"><a href="#cb33-505" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q2h. </span></span>
<span id="cb33-506"><a href="#cb33-506" aria-hidden="true" tabindex="-1"></a>Interpret the estimated beta coefficients for the following variables---</span>
<span id="cb33-507"><a href="#cb33-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-508"><a href="#cb33-508" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(1) <span class="in">`genderMale`</span></span>
<span id="cb33-509"><a href="#cb33-509" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(2) <span class="in">`log(hh_income)`</span></span>
<span id="cb33-510"><a href="#cb33-510" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(3) <span class="in">`schoolingHigh School Diploma`</span></span>
<span id="cb33-511"><a href="#cb33-511" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>(4) <span class="in">`net_asset`</span></span>
<span id="cb33-512"><a href="#cb33-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-513"><a href="#cb33-513" aria-hidden="true" tabindex="-1"></a>---from the model with <span class="in">`formula`</span> in Q2f.</span>
<span id="cb33-514"><a href="#cb33-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-515"><a href="#cb33-515" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpretation is not provided here.</span>
<span id="cb33-516"><a href="#cb33-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-517"><a href="#cb33-517" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-518"><a href="#cb33-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-519"><a href="#cb33-519" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q2i. </span></span>
<span id="cb33-520"><a href="#cb33-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-521"><a href="#cb33-521" aria-hidden="true" tabindex="-1"></a>Provide (1) the interpretation of the beta estimate corresponding to the following question---</span>
<span id="cb33-522"><a href="#cb33-522" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>How did the tax exemption of household income affect the <span class="in">`pension_saving`</span>?</span>
<span id="cb33-523"><a href="#cb33-523" aria-hidden="true" tabindex="-1"></a>---and (2) any intuitive explanations on it.</span>
<span id="cb33-524"><a href="#cb33-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-525"><a href="#cb33-525" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Answer</span>
<span id="cb33-526"><a href="#cb33-526" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Workers who had less than $3,000 in pension savings in 2005 had an incentive to further increase their pension savings in 2006, as the upper limit of income tax deduction increases. </span>
<span id="cb33-527"><a href="#cb33-527" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>On the other hand, workers who had more than $3,000 in pension savings in 2005 were hardly affected by the change in the upper limit. </span>
<span id="cb33-528"><a href="#cb33-528" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-529"><a href="#cb33-529" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;&lt;br&gt;</span></span>
<span id="cb33-530"><a href="#cb33-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-531"><a href="#cb33-531" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 3</span></span>
<span id="cb33-532"><a href="#cb33-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-533"><a href="#cb33-533" aria-hidden="true" tabindex="-1"></a>The following is the data.frame for Question 3.</span>
<span id="cb33-534"><a href="#cb33-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-537"><a href="#cb33-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-538"><a href="#cb33-538" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb33-539"><a href="#cb33-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-540"><a href="#cb33-540" aria-hidden="true" tabindex="-1"></a>NYComplaints <span class="ot">&lt;-</span> </span>
<span id="cb33-541"><a href="#cb33-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"https://bcdanl.github.io/data/NYComplaints.csv"</span>)</span>
<span id="cb33-542"><a href="#cb33-542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-543"><a href="#cb33-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-544"><a href="#cb33-544" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The data.frame, NYComplaints, contains information about complaints from New York City.</span>
<span id="cb33-545"><a href="#cb33-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-546"><a href="#cb33-546" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variable description</span></span>
<span id="cb33-547"><a href="#cb33-547" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`unique_key`</span>: Complaint identifier.</span>
<span id="cb33-548"><a href="#cb33-548" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`year_open`</span>, <span class="in">`month_open`</span>, <span class="in">`day_open`</span>: Date the casework is created by staff.</span>
<span id="cb33-549"><a href="#cb33-549" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`year_close`</span>, <span class="in">`month_close`</span>, <span class="in">`day_close`</span>: Date the casework was closed. </span>
<span id="cb33-550"><a href="#cb33-550" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>A casework could be closed because the issue is resolved or because no further action could be taken. </span>
<span id="cb33-551"><a href="#cb33-551" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`NA`</span> if the casework is not resolved.</span>
<span id="cb33-552"><a href="#cb33-552" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`complaint_type`</span>: Broader category designated by staff for the constituent casework. </span>
<span id="cb33-553"><a href="#cb33-553" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`complaint_type`</span> corresponds to NYC Council Legislative Committees.</span>
<span id="cb33-554"><a href="#cb33-554" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`descriptor`</span>: Specific category designated by staff for the constituent casework.</span>
<span id="cb33-555"><a href="#cb33-555" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`zip`</span>: Zip code of the constituent.</span>
<span id="cb33-556"><a href="#cb33-556" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`borough`</span>: Borough of the constituent.</span>
<span id="cb33-557"><a href="#cb33-557" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`city`</span>: City of the constituent.</span>
<span id="cb33-558"><a href="#cb33-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-559"><a href="#cb33-559" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-560"><a href="#cb33-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-561"><a href="#cb33-561" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q3a.</span></span>
<span id="cb33-562"><a href="#cb33-562" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate the number of observations for each <span class="in">`complaint_type`</span>.</span>
<span id="cb33-563"><a href="#cb33-563" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Find the top 10 most popular complaint types.</span>
<span id="cb33-564"><a href="#cb33-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-567"><a href="#cb33-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-568"><a href="#cb33-568" aria-hidden="true" tabindex="-1"></a>NYComplaints <span class="sc">%&gt;%</span> </span>
<span id="cb33-569"><a href="#cb33-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(complaint_type) <span class="sc">%&gt;%</span> </span>
<span id="cb33-570"><a href="#cb33-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb33-571"><a href="#cb33-571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-572"><a href="#cb33-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-573"><a href="#cb33-573" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-574"><a href="#cb33-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-575"><a href="#cb33-575" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q3b.</span></span>
<span id="cb33-576"><a href="#cb33-576" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate the number of observations for each <span class="in">`complaint_type`</span> for each <span class="in">`borough`</span>.</span>
<span id="cb33-577"><a href="#cb33-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-578"><a href="#cb33-578" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Find the top 3 most popular complaint types for each <span class="in">`borough`</span>.</span>
<span id="cb33-579"><a href="#cb33-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-582"><a href="#cb33-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-583"><a href="#cb33-583" aria-hidden="true" tabindex="-1"></a>NYComplaints <span class="sc">%&gt;%</span> </span>
<span id="cb33-584"><a href="#cb33-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(borough, complaint_type) <span class="sc">%&gt;%</span> </span>
<span id="cb33-585"><a href="#cb33-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-586"><a href="#cb33-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> n, </span>
<span id="cb33-587"><a href="#cb33-587" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb33-588"><a href="#cb33-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-589"><a href="#cb33-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-590"><a href="#cb33-590" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;br&gt;</span></span>
<span id="cb33-591"><a href="#cb33-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-592"><a href="#cb33-592" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q3c.</span></span>
<span id="cb33-593"><a href="#cb33-593" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Provide both (1) a single ggplot and (2) a simple comment to describe the monthly trend of the proportion of resolved complaints for each borough.</span>
<span id="cb33-594"><a href="#cb33-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-595"><a href="#cb33-595" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The proportion of resolved complaints in one borough is defined as the number of resolved complaints in one borough divided by the number of all complaints in that borough.</span>
<span id="cb33-596"><a href="#cb33-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-599"><a href="#cb33-599" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-600"><a href="#cb33-600" aria-hidden="true" tabindex="-1"></a>q3c <span class="ot">&lt;-</span> NYComplaints <span class="sc">%&gt;%</span> </span>
<span id="cb33-601"><a href="#cb33-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(borough)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-602"><a href="#cb33-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">resolved =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(year_close), T, F) ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-603"><a href="#cb33-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(borough, resolved, year_open, month_open) <span class="sc">%&gt;%</span> </span>
<span id="cb33-604"><a href="#cb33-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">opendate =</span> <span class="fu">make_date</span>(year_open, month_open)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-605"><a href="#cb33-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(opendate, borough, resolved) <span class="sc">%&gt;%</span> </span>
<span id="cb33-606"><a href="#cb33-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>year_open, <span class="sc">-</span>month_open) <span class="sc">%&gt;%</span> </span>
<span id="cb33-607"><a href="#cb33-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(tmp, borough, resolved) <span class="sc">%&gt;%</span> </span>
<span id="cb33-608"><a href="#cb33-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> tmp,</span>
<span id="cb33-609"><a href="#cb33-609" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> n,</span>
<span id="cb33-610"><a href="#cb33-610" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-611"><a href="#cb33-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_Bronx =</span> <span class="dv">100</span> <span class="sc">*</span> Bronx_TRUE<span class="sc">/</span>(Bronx_TRUE <span class="sc">+</span> Bronx_FALSE),</span>
<span id="cb33-612"><a href="#cb33-612" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_Brooklyn =</span> <span class="dv">100</span> <span class="sc">*</span> Brooklyn_TRUE<span class="sc">/</span>(Brooklyn_TRUE <span class="sc">+</span> Brooklyn_FALSE),</span>
<span id="cb33-613"><a href="#cb33-613" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_Manhattan =</span> <span class="dv">100</span> <span class="sc">*</span> Manhattan_TRUE<span class="sc">/</span>(Manhattan_TRUE <span class="sc">+</span> Manhattan_FALSE),</span>
<span id="cb33-614"><a href="#cb33-614" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_Queens =</span> <span class="dv">100</span> <span class="sc">*</span> Queens_TRUE<span class="sc">/</span>(Queens_TRUE <span class="sc">+</span> Queens_FALSE),</span>
<span id="cb33-615"><a href="#cb33-615" aria-hidden="true" tabindex="-1"></a>         <span class="at">prop_StatenIsland =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="st">`</span><span class="at">Staten Island_TRUE</span><span class="st">`</span><span class="sc">/</span>(<span class="st">`</span><span class="at">Staten Island_TRUE</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Staten Island_FALSE</span><span class="st">`</span>)</span>
<span id="cb33-616"><a href="#cb33-616" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-617"><a href="#cb33-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(opendate, <span class="fu">starts_with</span>(<span class="st">"prop"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-618"><a href="#cb33-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(prop_Bronx<span class="sc">:</span>prop_StatenIsland,</span>
<span id="cb33-619"><a href="#cb33-619" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">'borough'</span>,</span>
<span id="cb33-620"><a href="#cb33-620" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">'prop'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-621"><a href="#cb33-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">borough =</span> <span class="fu">str_replace</span>(borough, <span class="st">"prop_"</span>, <span class="st">""</span>))</span>
<span id="cb33-622"><a href="#cb33-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-623"><a href="#cb33-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-624"><a href="#cb33-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-625"><a href="#cb33-625" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(q3c) <span class="sc">+</span></span>
<span id="cb33-626"><a href="#cb33-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> opendate, <span class="at">y =</span> prop, </span>
<span id="cb33-627"><a href="#cb33-627" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="fu">fct_reorder2</span>(borough, opendate, prop)))</span>
<span id="cb33-628"><a href="#cb33-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-629"><a href="#cb33-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-630"><a href="#cb33-630" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">powered with github, quarto, and rstudio<br>byeong-hak choe, 2023</div>
  </div>
</footer>



</body></html>