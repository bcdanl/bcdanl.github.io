---
title: "DANL 200: Introduction to Data Analytics<br>Homework Assignment 4"
author: "Byeong-Hak Choe"
---

```{r setup, include = F}
library(tidyverse)
library(skimr)
library(stargazer)
library(broom)
library(scales)  # scales for ggplot
library(ggthemes)  # additional ggplot themes
library(hrbrthemes) # additional ggplot themes and color pallets
library(lubridate)
library(ggridges)
theme_set(theme_minimal()) # setting the minimal theme for ggplot
# setting default chunk options
knitr::opts_chunk$set(
	eval = F,
	echo = T,
	message = FALSE,
	warning = FALSE
)
```

Load R packages you need for Homework Assignment 4

```{r}
library(tidyverse)
library(skimr)
library(stargazer)
library(broom)
```

# Question 1

Load the DataFrfame for Question 1.

```{r}
path <- 'https://bcdanl.github.io/data/beer_markets.csv'
beer_mkts <- read_csv(path)
```

## Variable Description
- `hh`: an identifier of the purchasing household;
- `X_purchase_desc`: details on the purchased item;
- `quantity`: the number of items purchased;
- `brand`: Bud Light, Busch Light, Coors Light, Miller Lite, or Natural Light;
- `spent`: total dollar value of purchase;
- `beer_floz`: total volume of beer, in fluid ounces;
- `price_per_floz`: price per fl.oz. (i.e., beer spent/beer floz);
- `container`: the type of container;
- `promo`: Whether the item was promoted (coupon or otherwise);
- `market`: Scan-track market (or state if rural);
- demographic data, including gender, marital status, household income, class of work, race, education, age, the size of household, and whether or not the household has a microwave or a dishwasher.


## Q1a

- In the data.frame, `beer_mkts`, keep the observations with only `'CAN'` or `'NON REFILLABLE BOTTLE'` type containers.

- Randomly divide the data.frame, `beer_mkts`, into training and test data.frames, `dtrain` and `dtest`, respectively.

- Make sure that you can replicate the randomization.
  - Approximately 60% of observations in beer_mkts go to dtrain.
  - The rest of observations in beer_mkts go to dtest.

```{r}

```

<br><br>

## Q1b

Consider the following formulas.

```{r}
formula_1 <- 
  log(price_per_floz) ~  
        log(beer_floz) + brand + promo + market + container

formula_2 <- 
  log(price_per_floz) ~  
        log(beer_floz) * brand + promo + market + container 

formula_3 <- 
  log(price_per_floz) ~  
        log(beer_floz) * brand * promo + market + container

```

- For each of the formulas above, train the linear regression model using the `dtrain` data.frame.
  - Use `stargazer()` to summarize all the regression results in one table.

```{r}
stargazer( model_1, model_2, model_3, 
           type = 'text', 
           omit = c('market') ) 
```



<br><br>

## Q1c

- Across the three models in Q1b, how is the percentage change in the price of beer sensitive to the percentage change in the volume of beer purchases for each brand? 

```{r}

```

<br><br>

## Q1d

- Consider the following data.frames:

  - (1) the observations with `brand == 'BUD LIGHT'` only in the `dtrain` data.frame;
  - (2) the observations with `brand == 'BUSCH LIGHT'` only in the `dtrain` data.frame;
  - (3) the observations with `brand == 'COORS LIGHT'` only in the `dtrain` data.frame;
  - (4) the observations with `brand == 'MILLER LITE'` only in the `dtrain` data.frame;
  - (5) the observations with `brand == 'NATURAL LIGHT'` in the `dtrain` data.frame.
  

- Consider the forumla, `formula0`:

```{r}
formula0 <- 
  log(price_per_floz) ~ log(beer_floz) 
```

- Train the linear regression model with `formula0` using each of the data.frames above.

- How is the percentage change in the price of beer sensitive to the percentage change in the volume of beer purchases for each brand? 

- Are these sensitivities the same as the ones from the linear regression model with the following formula, `formula_int`, and the data, `dtrain`?

```{r}
formula_int <- 
  log(price_per_floz) ~ log(beer_floz) * brand
```


<br><br>

## Q1e

- Calculate the mean squared error (MSE) for each model in Q1b.

- Which model do you prefer most? Why?

<br>
