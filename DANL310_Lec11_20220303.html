<!DOCTYPE html>
<html>
<head>
  <title>DANL 310 Lecture 11</title>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />



  <meta name="date" content="2022-03-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'DANL 310 Lecture 11',
                        useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                      },

      // Author information
      presenters: [
            {
        name:  'Byeong-Hak Choe' ,
        company: '',
        gplus: '',
        twitter: '',
        www: '',
        github: ''
      },
            ]
    };
  </script>

  <script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
  <link href="site_libs/ioslides-13.5.1/fonts/fonts.css" rel="stylesheet" />
  <link href="site_libs/ioslides-13.5.1/theme/css/default.css" rel="stylesheet" />
  <link href="site_libs/ioslides-13.5.1/theme/css/phone.css" rel="stylesheet" />
  <script src="site_libs/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/prettify/prettify.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/prettify/lang-r.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/hammer.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/slide-controller.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/slide-deck.js"></script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    summary {
      display: list-item;
    }

    details > summary > p:only-child {
      display: inline;
    }

    slides > slide {
      -webkit-transition: all 0s ease-in-out;
      -moz-transition: all 0s ease-in-out;
      -o-transition: all 0s ease-in-out;
      transition: all 0s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0s;
      -moz-transition: opacity 0.6s ease-in 0s;
      -o-transition: opacity 0.6s ease-in 0s;
      transition: opacity 0.6s ease-in 0s;
      opacity: 0;
    }
/* https://github.com/ropensci/plotly/pull/524#issuecomment-468142578 */
slide:not(.current) .plotly.html-widget{
  display: block;
}

    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
            pre > code.sourceCode { white-space: pre; position: relative; }
            pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
            pre > code.sourceCode > span:empty { height: 1.2em; }
            .sourceCode { overflow: visible; }
            code.sourceCode > span { color: inherit; text-decoration: inherit; }
            div.sourceCode { margin: 1em 0; }
            pre.sourceCode { margin: 0; }
            @media screen {
            div.sourceCode { overflow: auto; }
            }
            @media print {
            pre > code.sourceCode { white-space: pre-wrap; }
            pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
            }
            pre.numberSource code
              { counter-reset: source-line 0; }
            pre.numberSource code > span
              { position: relative; left: -4em; counter-increment: source-line; }
            pre.numberSource code > span > a:first-child::before
              { content: counter(source-line);
                position: relative; left: -1em; text-align: right; vertical-align: baseline;
                border: none; display: inline-block;
                -webkit-touch-callout: none; -webkit-user-select: none;
                -khtml-user-select: none; -moz-user-select: none;
                -ms-user-select: none; user-select: none;
                padding: 0 4px; width: 4em;
                color: #aaaaaa;
              }
            pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
            div.sourceCode
              {   }
            @media screen {
            pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
            }
            code span.al { color: #ff0000; font-weight: bold; } /* Alert */
            code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
            code span.at { color: #7d9029; } /* Attribute */
            code span.bn { color: #40a070; } /* BaseN */
            code span.bu { } /* BuiltIn */
            code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
            code span.ch { color: #4070a0; } /* Char */
            code span.cn { color: #880000; } /* Constant */
            code span.co { color: #60a0b0; font-style: italic; } /* Comment */
            code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
            code span.do { color: #ba2121; font-style: italic; } /* Documentation */
            code span.dt { color: #902000; } /* DataType */
            code span.dv { color: #40a070; } /* DecVal */
            code span.er { color: #ff0000; font-weight: bold; } /* Error */
            code span.ex { } /* Extension */
            code span.fl { color: #40a070; } /* Float */
            code span.fu { color: #06287e; } /* Function */
            code span.im { } /* Import */
            code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
            code span.kw { color: #007020; font-weight: bold; } /* Keyword */
            code span.op { color: #666666; } /* Operator */
            code span.ot { color: #007020; } /* Other */
            code span.pp { color: #bc7a00; } /* Preprocessor */
            code span.sc { color: #4070a0; } /* SpecialChar */
            code span.ss { color: #bb6688; } /* SpecialString */
            code span.st { color: #4070a0; } /* String */
            code span.va { color: #19177c; } /* Variable */
            code span.vs { color: #4070a0; } /* VerbatimString */
            code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
        
  </style>


</head>

<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      
      <p data-config-presenter><!-- populated from slide_config.json --></p>
            <p style="margin-top: 6px; margin-left: -2px;">March 3, 2022</p>
          </hgroup>
  </slide>

<slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Refine your plots</h2></hgroup><article  id="refine-your-plots">

</article></slide><slide class=""><hgroup><h2>R packages</h2></hgroup><article  id="r-packages">

<pre class = 'prettyprint lang-r'>library(tidyverse)
library(socviz)
library(ggthemes)
library(ggridges)
library(ggrepel)
library(RColorBrewer)
library(dichromat)
theme_set(theme_minimal())</pre>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage" class="build faster">

<ul>
<li>You should choose a color palette based on the types of the data you are plotting.

<ul>
<li>An unordered categorical variable (e.g., &lsquo;Sex&rsquo; or &lsquo;Country&rsquo;) requires distinct colors that won’t be easily confused with one another.</li>
<li>An ordered categorical variable (e.g., &lsquo;Level of Education&rsquo;) requires a graded color scheme of some kind running from less to more or earlier to later.</li>
</ul></li>
</ul>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-1" class="build faster">

<ul>
<li><p>We choose color palettes for mappings through one of the <code>scale_</code> functions for <code>color</code> or <code>fill</code>.</p></li>
<li><p><code>RColorBrewer</code> package provides a wide range of named color palettes.</p>

<ul>
<li>You can access these colors by specifying the <code>scale_color_brewer()</code> or <code>scale_fill_brewer()</code> functions with <code>palette</code> parameter.</li>
</ul></li>
</ul>

</article></slide><slide class=""><hgroup><h2><code>RColorBrewer</code>’s sequential palettes</h2></hgroup><article  id="rcolorbrewers-sequential-palettes">

<img hight="85%" src='lec_figs/socviz_fig8_4.png' title=''/>

</article></slide><slide class=""><hgroup><h2><code>RColorBrewer</code>’s diverging palettes</h2></hgroup><article  id="rcolorbrewers-diverging-palettes">

<img hight="90%" src='lec_figs/socviz_fig8_5.png' title=''/>

</article></slide><slide class=""><hgroup><h2><code>RColorBrewer</code>’s qualitative palettes</h2></hgroup><article  id="rcolorbrewers-qualitative-palettes">

<img hight="90%" src='lec_figs/socviz_fig8_6.png' title=''/>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-2" class="build faster">

<pre class = 'prettyprint lang-r'>p &lt;- ggplot(data = organdata,
            mapping = aes(x = roads, y = donors, color = world))

p + geom_point(size = 2) + scale_color_brewer(palette = &quot;Set2&quot;) +
    theme(legend.position = &quot;top&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-3">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-3-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-4" class="build faster">

<pre class = 'prettyprint lang-r'>p &lt;- ggplot(data = organdata,
            mapping = aes(x = roads, y = donors, color = world))

p + geom_point(size = 2) + scale_color_brewer(palette = &quot;Pastel2&quot;) +
    theme(legend.position = &quot;top&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-5">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-5-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-6" class="build faster">

<pre class = 'prettyprint lang-r'>p &lt;- ggplot(data = organdata,
            mapping = aes(x = roads, y = donors, color = world))

p + geom_point(size = 2) + scale_color_brewer(palette = &quot;Dark2&quot;) +
    theme(legend.position = &quot;top&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-7">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-7-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-8" class="build faster">

<ul>
<li>We can also specify colors manually, via <code>scale_color_manual()</code> or <code>scale_fill_manual()</code>.

<ul>
<li>These functions take <code>values</code> argument that can be specified as vector of color names or hex colors.</li>
</ul></li>
</ul>

<pre class = 'prettyprint lang-r'>p &lt;- ggplot(data = organdata,
            mapping = aes(x = roads, y = donors, color = world))

p + geom_point(size = 2) + 
  scale_color_manual(values = c(&quot;#3c6ff8&quot;, &quot;#afd68d&quot;, &quot;#8467ad&quot;, &quot;#82857f&quot;)) +
  theme_minimal() + theme(legend.position = &quot;top&quot;) </pre>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-9">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-9-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-10" class="build faster">

<ul>
<li><p>Even though colorblind people can recognize a wide range of colors, it might be hard to differentiate between certain colors.</p>

<ul>
<li><code>dichromat</code> package provides a range of safe palettes and some useful functions for helping you approximately see what your current palette might look like to a viewer with one of several different kinds of color blindness.</li>
</ul></li>
</ul>

<pre class = 'prettyprint lang-r'>Default &lt;- brewer.pal(5, &quot;Set2&quot;)
types &lt;- c(&quot;deutan&quot;, &quot;protan&quot;, &quot;tritan&quot;)
names(types) &lt;- c(&quot;Deuteronopia&quot;, &quot;Protanopia&quot;, &quot;Tritanopia&quot;)

color_table &lt;- types %&gt;%
    purrr::map(~ dichromat(Default, .x)) %&gt;%
    as_tibble() %&gt;%
    add_column(Default, .before = TRUE)

color_table</pre>

<pre >## # A tibble: 5 × 4
##   Default Deuteronopia Protanopia Tritanopia
##   &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;     
## 1 #66C2A5 #AEAEA7      #BABAA5    #82BDBD   
## 2 #FC8D62 #B6B661      #9E9E63    #F29494   
## 3 #8DA0CB #9C9CCB      #9E9ECB    #92ABAB   
## 4 #E78AC3 #ACACC1      #9898C3    #DA9C9C   
## 5 #A6D854 #CACA5E      #D3D355    #B6C8C8</pre>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-11">

<ul>
<li>Let’s compare a default color palette with an approximation of how the same palette appears to people with one of three kinds of color blindness.</li>
</ul>

<pre class = 'prettyprint lang-r'>color_comp(color_table)</pre>

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-12-1.png" width="720" style="display: block; margin: auto;" /><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-12-2.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-12">

<ul>
<li><code>RColorBrewer</code> provides the color-blind friendly pallets.</li>
</ul>

<pre class = 'prettyprint lang-r'>display.brewer.all(n=NULL, type=&quot;all&quot;, select=NULL, exact.n=TRUE, colorblindFriendly=TRUE)</pre>

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-13-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Use color to your advantage</h2></hgroup><article  id="use-color-to-your-advantage-13">

<ul>
<li><code>RColorBrewer</code> provides the color-blind friendly pallets.</li>
</ul>

<pre class = 'prettyprint lang-r'>brewer.pal.info</pre>

<pre >##          maxcolors category colorblind
## BrBG            11      div       TRUE
## PiYG            11      div       TRUE
## PRGn            11      div       TRUE
## PuOr            11      div       TRUE
## RdBu            11      div       TRUE
## RdGy            11      div      FALSE
## RdYlBu          11      div       TRUE
## RdYlGn          11      div      FALSE
## Spectral        11      div      FALSE
## Accent           8     qual      FALSE
## Dark2            8     qual       TRUE
## Paired          12     qual       TRUE
## Pastel1          9     qual      FALSE
## Pastel2          8     qual      FALSE
## Set1             9     qual      FALSE
## Set2             8     qual       TRUE
## Set3            12     qual      FALSE
## Blues            9      seq       TRUE
## BuGn             9      seq       TRUE
## BuPu             9      seq       TRUE
## GnBu             9      seq       TRUE
## Greens           9      seq       TRUE
## Greys            9      seq       TRUE
## Oranges          9      seq       TRUE
## OrRd             9      seq       TRUE
## PuBu             9      seq       TRUE
## PuBuGn           9      seq       TRUE
## PuRd             9      seq       TRUE
## Purples          9      seq       TRUE
## RdPu             9      seq       TRUE
## Reds             9      seq       TRUE
## YlGn             9      seq       TRUE
## YlGnBu           9      seq       TRUE
## YlOrBr           9      seq       TRUE
## YlOrRd           9      seq       TRUE</pre>

</article></slide><slide class=""><hgroup><h2>Layer color and text together</h2></hgroup><article  id="layer-color-and-text-together" class="build faster">

<ul>
<li><p>Color is very useful when we want to pick out or highlight some aspect of our data.</p></li>
<li><p>Let’s do a simple exploratory analysis on the relationship between politics and race using <code>color</code>.</p></li>
<li><p>First, use <code>county_data</code> with a value of &ldquo;No&rdquo; on the <code>flipped</code> variable to draw a scatter plot on the <code>pop</code>-<code>black/100</code> plane.</p></li>
</ul>

<pre class = 'prettyprint lang-r'>party_colors &lt;- c(&quot;#2E74C0&quot;, &quot;#CB454A&quot;) # DEM Blue and REP Red

p0 &lt;- ggplot(data = subset(county_data,
                           flipped == &quot;No&quot;),
             mapping = aes(x = pop, y = black/100) )

p1 &lt;- p0 + geom_point(alpha = 0.15, color = &quot;gray50&quot;) +
    scale_x_log10(labels=scales::comma) 
p1</pre>

</article></slide><slide class=""><hgroup><h2>Layer color and text together</h2></hgroup><article  id="layer-color-and-text-together-1">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-16-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Layer color and text together</h2></hgroup><article  id="layer-color-and-text-together-2" class="build faster">

<ul>
<li>Next, we add a second <code>geom_point()</code> layer.

<ul>
<li>We choose the data with &ldquo;Yes&rdquo; counties on the <code>flipped</code> variable.</li>
<li>We map the <code>partywinner16</code> variable to the <code>color</code> aesthetic using <code>scale_color_manual(values = party_colors)</code>.</li>
</ul></li>
</ul>

<pre class = 'prettyprint lang-r'>p2 &lt;- p1 + geom_point(data = subset(county_data,
                                    flipped == &quot;Yes&quot;),
                      mapping = aes(x = pop, y = black/100,
                                    color = partywinner16)) +
    scale_color_manual(values = party_colors)

p2</pre>

</article></slide><slide class=""><hgroup><h2>Layer color and text together</h2></hgroup><article  id="layer-color-and-text-together-3">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-18-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Layer color and text together</h2></hgroup><article  id="layer-color-and-text-together-4" class="build faster">

<ul>
<li>Next, we set the y-axis scale and the labels.</li>
</ul>

<pre class = 'prettyprint lang-r'>p3 &lt;- p2 + scale_y_continuous(labels=scales::percent) +
    labs(color = &quot;County flipped to ... &quot;,
         x = &quot;County Population (log scale)&quot;,
         y = &quot;Percent Black Population&quot;,
         title = &quot;Flipped counties, 2016&quot;,
         caption = &quot;Counties in gray did not flip.&quot;)

p3</pre>

</article></slide><slide class=""><hgroup><h2>Layer color and text together</h2></hgroup><article  id="layer-color-and-text-together-5">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-20-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Layer color and text together</h2></hgroup><article  id="layer-color-and-text-together-6" class="build faster">

<ul>
<li>Finally, we add a third layer using the <code>geom_text_repel()</code> function.

<ul>
<li>We are interested in the <code>flipped</code> counties that have with a relatively high percentage of African-American residents (<code>black</code> &gt; 25).</li>
</ul></li>
</ul>

<pre class = 'prettyprint lang-r'>p4 &lt;- p3 + geom_text_repel(data = subset(county_data,
                                      flipped == &quot;Yes&quot; &amp;
                                      black  &gt; 25),
                           mapping = aes(x = pop,
                                   y = black/100,
                                   label = state), size = 2)

p4 + theme_minimal() +
    theme(legend.position=&quot;top&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Layer color and text together</h2></hgroup><article  id="layer-color-and-text-together-7">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-22-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Layer color and text together</h2></hgroup><article  id="layer-color-and-text-together-8">

<ul>
<li>We are now able to see the mappings, scales, and layers from the ggplot figures:

<ul>
<li>Which variables are mapped to <code>x</code> and <code>y</code></li>
<li>Which to to <code>color</code>, <code>fill</code>, <code>shape</code>, <code>label</code>, and so on.</li>
<li>What <code>geoms</code> were used to produce them?</li>
<li>How have the scales been adjusted?</li>
<li>Are the axes transformed?</li>
<li>Are the fill and color legends combined?</li>
<li>What is the base layer?</li>
<li>What has been drawn on top of it, and in what order?</li>
<li>Which upper layers are formed from subsets of the data?</li>
<li>Which are new datasets?</li>
<li>Are there annotations?</li>
</ul></li>
</ul>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes">

<ul>
<li>The following lists the ggplot themes:</li>
</ul>

<table class = 'rmdtable'>
<tr class="header">
<th align="left">theme</th>
<th align="left">theme</th>
</tr>
<tr class="odd">
<td align="left">theme_grey()</td>
<td align="left">theme_gray()</td>
</tr>
<tr class="even">
<td align="left">theme_bw()</td>
<td align="left">theme_linedraw()</td>
</tr>
<tr class="odd">
<td align="left">theme_light()</td>
<td align="left">theme_dark()</td>
</tr>
<tr class="even">
<td align="left"><code>theme_minimal()</code></td>
<td align="left">theme_classic()</td>
</tr>
<tr class="odd">
<td align="left">theme_void()</td>
<td align="left">theme_test()</td>
</tr>
</table>

<ul>
<li><code>ggthemes</code> package provides <code>theme_economist()</code> and <code>theme_wsj()</code>.</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-1" class="build faster">

<ul>
<li>If we want to change the overall look of it all at once, we can do that using ggplot’s theme engine.

<ul>
<li>Themes can be turned on or off using the <code>theme_set()</code> function.</li>
</ul></li>
</ul>

<pre class = 'prettyprint lang-r'>theme_set(theme_economist())
p4 + theme(legend.position=&quot;top&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-2">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-24-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-3" class="build faster">

<pre class = 'prettyprint lang-r'>theme_set(theme_wsj())
p4 + theme(plot.title = element_text(size = rel(0.6)),
           legend.title = element_text(size = rel(0.35)),
           plot.caption = element_text(size = rel(0.35)),
           legend.position = &quot;top&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-4">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-26-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-5" class="build faster">

<ul>
<li>We can adjust the text size using <code>element_text()</code> function.</li>
</ul>

<pre class = 'prettyprint lang-r'>theme_set(theme_wsj())
p4 + theme(plot.title = element_text(size = rel(0.6)),
           legend.title = element_text(size = rel(0.35)),
           plot.caption = element_text(size = rel(0.35)),
           legend.position = &quot;top&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-6">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-28-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-7" class="build faster">

<ul>
<li><code>cowplot</code> package provides <code>theme_cowplot()</code>.</li>
</ul>

<pre class = 'prettyprint lang-r'># install.packages(&quot;cowplot&quot;)
library(cowplot)
theme_set(theme_cowplot())
p4 + theme(legend.position=&quot;top&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-8">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-30-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-9" class="build faster">

<ul>
<li><code>hrbrthemes</code> package provides <code>theme_ipsum()</code>, which is similar to the theme used in our textbook.</li>
</ul>

<pre class = 'prettyprint lang-r'># install.packages(&quot;hrbrthemes&quot;)
library(hrbrthemes)
theme_set(theme_ipsum())
p4 + theme(legend.position=&quot;top&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-10">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-32-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-11" class="build faster">

<ul>
<li>We can also change font and color of the text.</li>
</ul>

<pre class = 'prettyprint lang-r'>p4 + theme(legend.position = &quot;top&quot;,
           plot.title = element_text(size=rel(2),
                                     lineheight=.5,
                                     family=&quot;Times&quot;,
                                     face=&quot;bold.italic&quot;,
                                     colour=&quot;orange&quot;),
           axis.text.x = element_text(size=rel(1.1),
                                      family=&quot;Courier&quot;,
                                      face=&quot;bold&quot;,
                                      color=&quot;purple&quot;))</pre>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-12">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-34-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-13" class="build faster">

<ul>
<li>We can also use <code>element_blank()</code> to remove a number of elements by naming them and making them disappear.</li>
</ul>

<pre class = 'prettyprint lang-r'>p4 + theme(legend.position = &quot;top&quot;,
           plot.title = element_text(size=rel(2),
                                     lineheight=.5,
                                     family=&quot;Times&quot;,
                                     face=&quot;bold.italic&quot;,
                                     colour=&quot;orange&quot;),
           axis.text.x = element_blank())</pre>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-14">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-36-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-15" class="build faster">

<ul>
<li><p>Let’s create an effective small multiple of the age distribution of General Social Survey (GSS) respondents over the years using <code>gss_lon</code> data.</p></li>
<li><p>First, we need to calculate the mean age of the respondents for each year of interest.</p></li>
<li><p>We will look at distributions about every four years since the beginning.</p></li>
</ul>

<pre class = 'prettyprint lang-r'>yrs &lt;- c(seq(1972, 1988, 4), 1993, seq(1996, 2016, 4))

mean_age &lt;- gss_lon %&gt;%
    filter(age %nin% NA &amp;&amp; year %in% yrs) %&gt;%
    group_by(year) %&gt;%
    summarize(xbar = round(mean(age, na.rm = TRUE), 0))

mean_age$y &lt;- 0.3 # to position the age as a text label. 

yr_labs &lt;- data.frame(x = 85, y = 0.8,
                      year = yrs)</pre>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-16" class="build faster">

<pre class = 'prettyprint lang-r'>p &lt;- ggplot(data = subset(gss_lon, year %in% yrs),
            mapping = aes(x = age))
p1 &lt;- p + geom_density(fill = &quot;black&quot;, color = FALSE,
                       alpha = 0.9, mapping = aes(y = ..scaled..)) +
    geom_vline(data = subset(mean_age, year %in% yrs),
               aes(xintercept = xbar), color = &quot;white&quot;, size = 0.5) +
    geom_text(data = subset(mean_age, year %in% yrs),
              aes(x = xbar, y = y, label = xbar), nudge_x = 7.5,
              color = &quot;white&quot;, size = 3.5, hjust = 1) +
    geom_text(data = subset(yr_labs, year %in% yrs),
              aes(x = x, y = y, label = year)) +
    facet_grid(year ~ ., switch = &quot;y&quot;)
p1</pre>

<ul>
<li><p>The first <code>geom_text()</code> call uses a <code>nudge</code> argument to push the label slightly to the right of its x-value (<code>nudge_x</code>).</p></li>
<li><p>In the <code>facet_grid()</code> we use the <code>switch</code> argument to move the labels to the left.</p></li>
</ul>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-17" class="build faster">

<ul>
<li>With the structure of the plot in place, we then style the elements in the way that we want, using a series of instructions to <code>theme()</code>.</li>
</ul>

<pre class = 'prettyprint lang-r'>p2a &lt;- p1 + theme(plot.title = element_text(size = 16),
           axis.text.x= element_text(size = 12),
           axis.line.x = NULL,
           axis.title.y=element_blank(),
           axis.text.y=element_blank(),
           axis.ticks.y = element_blank(),
           strip.background = element_blank(),
           strip.text.y = element_blank(),
           panel.grid.major = element_blank(),
           panel.grid.minor = element_blank()) +
  labs(x = &quot;Age&quot;,
       y = NULL,
       title = &quot;Age Distribution of\nGSS Respondents&quot;)
p2a</pre>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-18" class="build faster">

<ul>
<li><code>ggridges</code> allows the distributions to overlap vertically.

<ul>
<li>It is especially useful for repeated distributional measures that change in a clear direction.</li>
</ul></li>
</ul>

<pre class = 'prettyprint lang-r'>p &lt;- ggplot(data = gss_lon,
            mapping = aes(x = age, y = factor(year, levels = rev(unique(year)),
                                     ordered = TRUE)))
p2b &lt;- p + geom_density_ridges(alpha = 0.6, fill = &quot;lightblue&quot;, scale = 1.5) +
    scale_x_continuous(breaks = c(25, 50, 75)) +
    scale_y_discrete(expand = c(0.01, 0)) + 
    labs(x = &quot;Age&quot;, y = NULL,
         title = &quot;Age Distribution of\nGSS Respondents&quot;) +
    theme_ridges() +
    theme(title = element_text(size = 16, face = &quot;bold&quot;))
p2b</pre>

</article></slide><slide class=""><hgroup><h2>Change the appearance of plots with themes</h2></hgroup><article  id="change-the-appearance-of-plots-with-themes-19">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-44-1.png" width="720" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Arrange plots with <code>grid.arrange()</code></h2></hgroup><article  id="arrange-plots-with-grid.arrange" class="build faster">

<ul>
<li><code>gridExtra</code> package provides <code>grid.arrange()</code> function.

<ul>
<li><code>grid.arrange()</code> arranges multiple <code>ggplot</code> objects on a page, and draw tables of figures.</li>
</ul></li>
</ul>

<pre class = 'prettyprint lang-r'>library(gridExtra)
grid.arrange(p2a, p2b, nrow = 1)   # sub-figures</pre>

</article></slide><slide class=""><hgroup><h2>Arrange plots with <code>grid.arrange()</code></h2></hgroup><article  id="arrange-plots-with-grid.arrange-1">

<p><img src="DANL310_Lec11_20220303_files/figure-html/unnamed-chunk-46-1.png" width="720" style="display: block; margin: auto;" /></p></article></slide>


  <slide class="backdrop"></slide>

</slides>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
