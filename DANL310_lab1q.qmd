---
title: "R Visualization Lab 1 - Maps "
author: "Byeong-Hak Choe"
editor: visual
---

```{r setup, include = FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)
library(ggthemes)
library(ggtech)
library(ggthemr)
library(ggthemes)
library(hrbrthemes)
library(hexbin)
library(ggforce)
library(skimr)

knitr::opts_chunk$set(fig.width=8, fig.height=5)  

theme_set(theme_ipsum() +
          theme(strip.background =element_rect(fill="lightgray")))
```

### Loading R packages

```{r, eval = T, echo = T}
library(tidyverse)
library(skimr)
library(ggthemes)
library(socviz)
```

# Question 1 - Climate Opinion Map

The following data is for Question 1:

```{r, echo = T, eval = T, message=F}
climate_opinion_long <- read_csv(
  'https://bcdanl.github.io/data/climate_opinion_2021.csv')
```

```{r, result = 'asis', echo = F, message = F, warning = F}
rmarkdown::paged_table(climate_opinion_long) 
```

<br><br>

## Variable Description

-   `belief`:
    -   `human`: Estimated percentage who think that global warming is caused mostly by human activities.
    -   `happening`: Estimated percentage who think that global warming is happening.

```{r, echo = T, eval = T}
climate_opinion_long <- read_csv(
  'https://bcdanl.github.io/data/climate_opinion_2021.csv')

climate_opinion_long
```

## Q1a.

-   Filter `climate_opinion_long`, so that `climate_opinion_long` has only estimated percentage who think that global warming is caused mostly by human activities.

-   Then join the two data.frames `socviz::county_map` and the resulting data.frame above.

```{r, echo = F, eval = T, out.height= 12, out.width=8}

climate_opinion_long <- climate_opinion_long %>% 
  filter(belief == 'human')

county_map <- county_map
county_map$id <- as.integer(county_map$id)
county_full <- left_join(county_map, climate_opinion_long)

```

## Q1b.

-   Replicate the following map.
    -   Do not use `coord_map(projection = "albers", lat0 = 39, lat1 = 45)`.



```{r, echo = F, eval = T}
knitr::include_graphics("lec_figs/climate-opinion-map.png")
```
