---
title: "R Visualization Lab 2 - Maps 2"
author: "Byeong-Hak Choe"
editor: visual
---

```{r setup, include = FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)
library(ggthemes)
library(ggtech)
library(ggthemr)
library(ggthemes)
library(hrbrthemes)
library(hexbin)
library(ggforce)
library(skimr)

knitr::opts_chunk$set(fig.width=8, fig.height=5)  

theme_set(theme_ipsum() +
          theme(strip.background =element_rect(fill="lightgray")))
```

### Loading R packages

```{r, eval = T, echo = T}
library(tidyverse)
library(socviz)
library(lubridate)
library(geofacet)
```

# Question 1 - Unemployment Rate Maps with  `geofacet::facet_geo()`

The following data is for Question 1:

```{r, echo = T, eval = T, message=F}
unemp_house_prices <- read_csv(
  'https://bcdanl.github.io/data/unemp_house_prices.csv')

```

```{r, result = 'asis', echo = F, message = F, warning = F}
rmarkdown::paged_table(unemp_house_prices) 
```

<br><br>


- Use `geom_area()`, `geom_line()`, and `facet_geo(~state, labeller = adjust_labels)` to replicate the following figure

```{r, eval = F, echo = T}
adjust_labels <- as_labeller(
  function(x) {
    case_when(
      x == "New Hampshire" ~ "N. Hampshire",
      x == "District of Columbia" ~ "DC",
      TRUE ~ x
    )
  }
)
```

```{r, echo = F, eval = T}
knitr::include_graphics("lec_figs/statemap-unemp.png")
```


# Question 2 - Election maps and data clearning

The following data is for Question 2:

```{r, echo = T, eval = T, message=F}
election_panel <- read_csv(
  'https://bcdanl.github.io/data/election_panel.csv')

```

```{r, result = 'asis', echo = F, message = F, warning = F}
rmarkdown::paged_table(election_panel) 
```

-   Replicate the following map.
    -   Do not use `coord_map(projection = "albers", lat0 = 39, lat1 = 45)`.

```{r, echo = F, eval = T}
knitr::include_graphics("lec_figs/election-map-facet.png")
```


