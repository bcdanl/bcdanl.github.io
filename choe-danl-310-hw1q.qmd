---
title: "DANL 310: Data Visualization and Presentation<br>Homework Assignment 1"
author: "Byeong-Hak Choe"
editor: visual
---

```{r setup, include = F}
library(tidyverse)
library(gapminder)
library(skimr)   # a better summary of data.frame
library(scales)  # scales for ggplot
library(ggthemes)  # additional ggplot themes
library(hrbrthemes) # additional ggplot themes and color pallets
library(lubridate)
library(ggridges)
theme_set(theme_minimal()) # setting the minimal theme for ggplot
# setting default chunk options
knitr::opts_chunk$set(
	eval = T,
	echo = F,
	message = FALSE,
	warning = FALSE
)
```

# Question 1

Renovate your personal website on GitHub using Quarto.

  - FAQ about Quarto for R Markdown users are provided below: <https://quarto.org/docs/faq/rmarkdown.html>

  - A guide for creating a Quarto website is provided in the following webpage: <https://quarto.org/docs/websites/>.

  - You can also simply download the template for the Quarto website using the following command in Terminal:

```{bash, eval = F, echo = T}
git clone https://github.com/bcdanl/danl-web-template.git
```

# Question 2

Provide ggplot codes to replicate the given figure.


## Q2a.
Use the following data.frame for Q2a, Q2b, and Q2c.
```{r, echo = T, eval = F}
ncdc_temp <- read_csv(
  'https://bcdanl.github.io/data/ncdc_temp_cleaned.csv')
```

```{r}
ncdc_temp <- read_csv(
  'https://bcdanl.github.io/data/ncdc_temp_cleaned.csv')

ggplot(ncdc_temp, aes(x = date, y = temperature, color = location)) +
  geom_line(size = 1) +
  scale_x_date(name = "month", limits = c(ymd("0000-01-01"), ymd("0001-01-04")),
               breaks = c(ymd("0000-01-01"), ymd("0000-04-01"), ymd("0000-07-01"),
                          ymd("0000-10-01"), ymd("0001-01-01")),
               labels = c("Jan", "Apr", "Jul", "Oct", "Jan"), expand = c(1/366, 0)) + 
  scale_y_continuous(limits = c(19.9, 107),
                     breaks = seq(20, 100, by = 20),
                     name = "temperature (°F)") +
  theme(legend.title.align = 0.5)
```

## Q2b

```{r}
ncdc_temp <- read_csv(
  'https://bcdanl.github.io/data/ncdc_temp_cleaned.csv')

ggplot(ncdc_temp, aes(x = month, y = temperature)) +
  geom_boxplot(fill = 'grey90') + 
  xlab("month") + 
  ylab("mean temperature (°F)") +
  theme_clean()
```




## Q2c

```{r}
ncdc_temp <- read_csv(
  'https://bcdanl.github.io/data/ncdc_temp_cleaned.csv')

ggplot(ncdc_temp, aes(x = temperature, y = month)) +
  geom_density_ridges(
    scale = 3, rel_min_height = 0.01,
    bandwidth = 3.4, fill = "#56B4E9", color = "white"
  ) +
  scale_x_continuous(
    name = "mean temperature (°F)",
    expand = c(0, 0), breaks = c(0, 25, 50, 75)
  ) +
  scale_y_discrete(name = "month", expand = c(0, .2, 0, 2.6)) +
  theme(
    plot.margin = margin(3, 7, 3, 1.5)
  )
```


## Q2d

Use `ggplot::mtcars` for Q2d.

```{r}
m<-ggplot(data = mtcars, aes(x = disp, y = mpg, color = hp))

m + geom_point(aes(color = hp)) +
  labs(x = "displacement(cu. in.)", y = "fuel efficiency(mpg)")+
  scale_color_gradient()+
  scale_fill_brewer(palette = "Emrld")
```


## Q2e

Use the following data.frame for Q2e.
```{r, echo = T, eval = F}
popgrowth_df <- read_csv(
  'https://bcdanl.github.io/data/popgrowth.csv')
```


```{r}
popgrowth_df <- read_csv(
  'https://bcdanl.github.io/data/popgrowth.csv')

ggplot(popgrowth_df, aes(x = reorder(state, popgrowth),
                         y = 100*popgrowth, 
                         fill = region)) + 
  geom_col() + 
  scale_y_continuous(
    limits = c(-.6, 37.5), expand = c(0, 0),
    labels = scales::percent_format(accuracy = 1, scale = 1),
    name = "population growth, 2000 to 2010"
  ) +
  coord_flip() + 
  theme(legend.position = c(.67, .4),
        axis.text.y = element_text( size = 6, margin = margin(t = 0, r = 0, b = 0, l = 0) )) 
```



## Q2f

Use the following data.frame for Q2f.
```{r, echo = T, eval = F}
male_Aus <- read_csv(
  'https://bcdanl.github.io/data/aus_athletics_male.csv')
```


```{r}
male_Aus <- read_csv(
  'https://bcdanl.github.io/data/aus_athletics_male.csv')

colors <- c("#BD3828", rep("#808080", 4))
fills <- c("#BD3828D0", rep("#80808080", 4))

ggplot(male_Aus, aes(x=height, y=pcBfat, 
                     shape=sport, color = sport, fill = sport)) +
  geom_point(size = 3) +
  scale_shape_manual(values = 21:25) +
  scale_color_manual(values = colors) +
  scale_fill_manual(values = fills) +
  xlab("height (cm)") +
  ylab("% body fat") 
```



## Q2g

Use the following data.frame for Q2g.
```{r, echo = T, eval = F}
titanic <- read_csv(
  'https://bcdanl.github.io/data/titanic_cleaned.csv')
```


```{r}
titanic <- read_csv(
  'https://bcdanl.github.io/data/titanic_cleaned.csv')

ggplot(titanic, aes(x = age, y = ..count..)) +
  geom_density_line(
    data = select(titanic, -sex), 
    aes(fill = "all passengers"),
    color = "transparent"
  ) + 
  geom_density_line(aes(fill = sex), bw = 2, color = "transparent") +
  scale_x_continuous(limits = c(0, 75), name = "passenger age (years)", expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 26), name = "count", expand = c(0, 0)) +
  scale_fill_manual(
    values = c("#b3b3b3a0", "#0072B2", "#D55E00"), 
    breaks = c("all passengers", "male", "female"),
    labels = c("all passengers  ", "males  ", "females"),
    name = NULL,
    guide = guide_legend(direction = "horizontal")
  ) +
  coord_cartesian(clip = "off") +
  facet_wrap(~sex) +
  theme(
    axis.line.x = element_blank(),
    strip.text = element_text(size = 14, margin = margin(0, 0, 0.2, 0, "cm")),
    legend.position = "bottom",
    legend.justification = "right",
    legend.margin = margin(4.5, 0, 1.5, 0, "pt"),
    legend.spacing.x = grid::unit(4.5, "pt"),
    legend.spacing.y = grid::unit(0, "pt"),
    legend.box.spacing = grid::unit(0, "cm")
  )
```




## Q2h

Use the following data.frame for Q2h.
```{r, echo = T, eval = F}
cows_filtered <- read_csv(
  'https://bcdanl.github.io/data/cows_filtered.csv')
```


```{r}
cows_filtered <- read_csv(
  'https://bcdanl.github.io/data/cows_filtered.csv')

ggplot(cows_filtered, aes(x = butterfat, 
                          color = breed, fill = breed)) + 
  geom_density_line( alpha = .2) +
  scale_x_continuous(
    expand = c(0, 0),
    labels = scales::percent_format(accuracy = 1, scale = 1),
    name = "butterfat contents"
  ) +
  scale_y_continuous(limits = c(0, 1.99), expand = c(0, 0)) +
  coord_cartesian(clip = "off") +
  theme(axis.line.x = element_blank())
```

