---
title: "Python Lab 1 - Pandas Group Operations and apply()"
author: "Byeong-Hak Choe"
editor: visual
---

## Load Libraries

```{python, eval = F}
import pandas as pd
from skimpy import skim
```

<br><br>

# Question 1

## Load `DataFrame`

```{python, eval = F}
df_ny = pd.read_csv('https://bcdanl.github.io/data/NY_pinc_pop.csv')
df_ny.head(10)
```

- Variable Description
    - `FIPS`: ID number for a county
    - `pincp`: average personal income in a county `X` in year `Y`
    - `pop_18_24`: population 18 to 24 years
    - `pop_25_over`: population 25 years and over

- Summarize DataFrame `df_ny`.


```{python, eval = F}
skim(df_ny)
```


```{python, eval = F}
df_ny.describe()
```


```{python, eval = F}
df_ny.groupby('year')['pincp'].describe()
```


```{python, eval = F}
df_ny.groupby('year')['pop_18_24'].describe()
```


```{python, eval = F}
df_ny.groupby('year')['pop_25_over'].describe()
```



## Q1a

- Use `.sort_values()` to find the top 5 rich counties in NY for each year.
  - Do not use `.apply()`

<br><br>


## Q1b

- Use `.rank()` to find the top 5 rich counties in NY for each year.
  - Do not use `.apply()`

<br><br>


## Q1c

- Use `apply()` with a `lambda` function  and `.sort_values()` to find the top 5 rich counties in NY for each year.

<br><br>

## Q1d

- Write a function with `def` and `.sort_values()` that selects the top 5 `pincp` values.

- Then, use the `def`ined function in `apply()` to find the top 5 rich counties in NY for each year.

<br><br>

## Q1e

- Visualize the yearly trend of the mean level of `pincp`.


